
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>elasticsearch.client &#8212; OneGov Docs 0.0.1 documentation</title>
    <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for elasticsearch.client</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">unicode_literals</span>
<span class="kn">import</span> <span class="nn">logging</span>

<span class="kn">from</span> <span class="nn">..transport</span> <span class="k">import</span> <span class="n">Transport</span>
<span class="kn">from</span> <span class="nn">..exceptions</span> <span class="k">import</span> <span class="n">TransportError</span>
<span class="kn">from</span> <span class="nn">..compat</span> <span class="k">import</span> <span class="n">string_types</span><span class="p">,</span> <span class="n">urlparse</span><span class="p">,</span> <span class="n">unquote</span>
<span class="kn">from</span> <span class="nn">.indices</span> <span class="k">import</span> <span class="n">IndicesClient</span>
<span class="kn">from</span> <span class="nn">.ingest</span> <span class="k">import</span> <span class="n">IngestClient</span>
<span class="kn">from</span> <span class="nn">.cluster</span> <span class="k">import</span> <span class="n">ClusterClient</span>
<span class="kn">from</span> <span class="nn">.cat</span> <span class="k">import</span> <span class="n">CatClient</span>
<span class="kn">from</span> <span class="nn">.nodes</span> <span class="k">import</span> <span class="n">NodesClient</span>
<span class="kn">from</span> <span class="nn">.remote</span> <span class="k">import</span> <span class="n">RemoteClient</span>
<span class="kn">from</span> <span class="nn">.snapshot</span> <span class="k">import</span> <span class="n">SnapshotClient</span>
<span class="kn">from</span> <span class="nn">.tasks</span> <span class="k">import</span> <span class="n">TasksClient</span>
<span class="kn">from</span> <span class="nn">.xpack</span> <span class="k">import</span> <span class="n">XPackClient</span>
<span class="kn">from</span> <span class="nn">.utils</span> <span class="k">import</span> <span class="n">query_params</span><span class="p">,</span> <span class="n">_make_path</span><span class="p">,</span> <span class="n">SKIP_IN_PATH</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;elasticsearch&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_normalize_hosts</span><span class="p">(</span><span class="n">hosts</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Helper function to transform hosts argument to</span>
<span class="sd">    :class:`~elasticsearch.Elasticsearch` to a list of dicts.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># if hosts are empty, just defer to defaults down the line</span>
    <span class="k">if</span> <span class="n">hosts</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[{}]</span>

    <span class="c1"># passed in just one string</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">hosts</span><span class="p">,</span> <span class="n">string_types</span><span class="p">):</span>
        <span class="n">hosts</span> <span class="o">=</span> <span class="p">[</span><span class="n">hosts</span><span class="p">]</span>

    <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># normalize hosts to dicts</span>
    <span class="k">for</span> <span class="n">host</span> <span class="ow">in</span> <span class="n">hosts</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">string_types</span><span class="p">):</span>
            <span class="k">if</span> <span class="s2">&quot;://&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">host</span><span class="p">:</span>
                <span class="n">host</span> <span class="o">=</span> <span class="s2">&quot;//</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">host</span>

            <span class="n">parsed_url</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="n">host</span><span class="p">)</span>
            <span class="n">h</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="n">parsed_url</span><span class="o">.</span><span class="n">hostname</span><span class="p">}</span>

            <span class="k">if</span> <span class="n">parsed_url</span><span class="o">.</span><span class="n">port</span><span class="p">:</span>
                <span class="n">h</span><span class="p">[</span><span class="s2">&quot;port&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">parsed_url</span><span class="o">.</span><span class="n">port</span>

            <span class="k">if</span> <span class="n">parsed_url</span><span class="o">.</span><span class="n">scheme</span> <span class="o">==</span> <span class="s2">&quot;https&quot;</span><span class="p">:</span>
                <span class="n">h</span><span class="p">[</span><span class="s2">&quot;port&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">parsed_url</span><span class="o">.</span><span class="n">port</span> <span class="ow">or</span> <span class="mi">443</span>
                <span class="n">h</span><span class="p">[</span><span class="s2">&quot;use_ssl&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">if</span> <span class="n">parsed_url</span><span class="o">.</span><span class="n">username</span> <span class="ow">or</span> <span class="n">parsed_url</span><span class="o">.</span><span class="n">password</span><span class="p">:</span>
                <span class="n">h</span><span class="p">[</span><span class="s2">&quot;http_auth&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span>
                    <span class="n">unquote</span><span class="p">(</span><span class="n">parsed_url</span><span class="o">.</span><span class="n">username</span><span class="p">),</span>
                    <span class="n">unquote</span><span class="p">(</span><span class="n">parsed_url</span><span class="o">.</span><span class="n">password</span><span class="p">),</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="n">parsed_url</span><span class="o">.</span><span class="n">path</span> <span class="ow">and</span> <span class="n">parsed_url</span><span class="o">.</span><span class="n">path</span> <span class="o">!=</span> <span class="s2">&quot;/&quot;</span><span class="p">:</span>
                <span class="n">h</span><span class="p">[</span><span class="s2">&quot;url_prefix&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">parsed_url</span><span class="o">.</span><span class="n">path</span>

            <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">host</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">out</span>


<div class="viewcode-block" id="Elasticsearch"><a class="viewcode-back" href="../../onegov_testing.html#onegov_testing.fixtures.Elasticsearch">[docs]</a><span class="k">class</span> <span class="nc">Elasticsearch</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Elasticsearch low-level client. Provides a straightforward mapping from</span>
<span class="sd">    Python to ES REST endpoints.</span>

<span class="sd">    The instance has attributes ``cat``, ``cluster``, ``indices``, ``ingest``,</span>
<span class="sd">    ``nodes``, ``snapshot`` and ``tasks`` that provide access to instances of</span>
<span class="sd">    :class:`~elasticsearch.client.CatClient`,</span>
<span class="sd">    :class:`~elasticsearch.client.ClusterClient`,</span>
<span class="sd">    :class:`~elasticsearch.client.IndicesClient`,</span>
<span class="sd">    :class:`~elasticsearch.client.IngestClient`,</span>
<span class="sd">    :class:`~elasticsearch.client.NodesClient`,</span>
<span class="sd">    :class:`~elasticsearch.client.SnapshotClient` and</span>
<span class="sd">    :class:`~elasticsearch.client.TasksClient` respectively. This is the</span>
<span class="sd">    preferred (and only supported) way to get access to those classes and their</span>
<span class="sd">    methods.</span>

<span class="sd">    You can specify your own connection class which should be used by providing</span>
<span class="sd">    the ``connection_class`` parameter::</span>

<span class="sd">        # create connection to localhost using the ThriftConnection</span>
<span class="sd">        es = Elasticsearch(connection_class=ThriftConnection)</span>

<span class="sd">    If you want to turn on :ref:`sniffing` you have several options (described</span>
<span class="sd">    in :class:`~elasticsearch.Transport`)::</span>

<span class="sd">        # create connection that will automatically inspect the cluster to get</span>
<span class="sd">        # the list of active nodes. Start with nodes running on &#39;esnode1&#39; and</span>
<span class="sd">        # &#39;esnode2&#39;</span>
<span class="sd">        es = Elasticsearch(</span>
<span class="sd">            [&#39;esnode1&#39;, &#39;esnode2&#39;],</span>
<span class="sd">            # sniff before doing anything</span>
<span class="sd">            sniff_on_start=True,</span>
<span class="sd">            # refresh nodes after a node fails to respond</span>
<span class="sd">            sniff_on_connection_fail=True,</span>
<span class="sd">            # and also every 60 seconds</span>
<span class="sd">            sniffer_timeout=60</span>
<span class="sd">        )</span>

<span class="sd">    Different hosts can have different parameters, use a dictionary per node to</span>
<span class="sd">    specify those::</span>

<span class="sd">        # connect to localhost directly and another node using SSL on port 443</span>
<span class="sd">        # and an url_prefix. Note that ``port`` needs to be an int.</span>
<span class="sd">        es = Elasticsearch([</span>
<span class="sd">            {&#39;host&#39;: &#39;localhost&#39;},</span>
<span class="sd">            {&#39;host&#39;: &#39;othernode&#39;, &#39;port&#39;: 443, &#39;url_prefix&#39;: &#39;es&#39;, &#39;use_ssl&#39;: True},</span>
<span class="sd">        ])</span>

<span class="sd">    If using SSL, there are several parameters that control how we deal with</span>
<span class="sd">    certificates (see :class:`~elasticsearch.Urllib3HttpConnection` for</span>
<span class="sd">    detailed description of the options)::</span>

<span class="sd">        es = Elasticsearch(</span>
<span class="sd">            [&#39;localhost:443&#39;, &#39;other_host:443&#39;],</span>
<span class="sd">            # turn on SSL</span>
<span class="sd">            use_ssl=True,</span>
<span class="sd">            # make sure we verify SSL certificates</span>
<span class="sd">            verify_certs=True,</span>
<span class="sd">            # provide a path to CA certs on disk</span>
<span class="sd">            ca_certs=&#39;/path/to/CA_certs&#39;</span>
<span class="sd">        )</span>

<span class="sd">    SSL client authentication is supported</span>
<span class="sd">    (see :class:`~elasticsearch.Urllib3HttpConnection` for</span>
<span class="sd">    detailed description of the options)::</span>

<span class="sd">        es = Elasticsearch(</span>
<span class="sd">            [&#39;localhost:443&#39;, &#39;other_host:443&#39;],</span>
<span class="sd">            # turn on SSL</span>
<span class="sd">            use_ssl=True,</span>
<span class="sd">            # make sure we verify SSL certificates</span>
<span class="sd">            verify_certs=True,</span>
<span class="sd">            # provide a path to CA certs on disk</span>
<span class="sd">            ca_certs=&#39;/path/to/CA_certs&#39;,</span>
<span class="sd">            # PEM formatted SSL client certificate</span>
<span class="sd">            client_cert=&#39;/path/to/clientcert.pem&#39;,</span>
<span class="sd">            # PEM formatted SSL client key</span>
<span class="sd">            client_key=&#39;/path/to/clientkey.pem&#39;</span>
<span class="sd">        )</span>

<span class="sd">    Alternatively you can use RFC-1738 formatted URLs, as long as they are not</span>
<span class="sd">    in conflict with other options::</span>

<span class="sd">        es = Elasticsearch(</span>
<span class="sd">            [</span>
<span class="sd">                &#39;http://user:secret@localhost:9200/&#39;,</span>
<span class="sd">                &#39;https://user:secret@other_host:443/production&#39;</span>
<span class="sd">            ],</span>
<span class="sd">            verify_certs=True</span>
<span class="sd">        )</span>

<span class="sd">    By default, `JSONSerializer</span>
<span class="sd">    &lt;https://github.com/elastic/elasticsearch-py/blob/master/elasticsearch/serializer.py#L24&gt;`_</span>
<span class="sd">    is used to encode all outgoing requests.</span>
<span class="sd">    However, you can implement your own custom serializer::</span>

<span class="sd">        from elasticsearch.serializer import JSONSerializer</span>

<span class="sd">        class SetEncoder(JSONSerializer):</span>
<span class="sd">            def default(self, obj):</span>
<span class="sd">                if isinstance(obj, set):</span>
<span class="sd">                    return list(obj)</span>
<span class="sd">                if isinstance(obj, Something):</span>
<span class="sd">                    return &#39;CustomSomethingRepresentation&#39;</span>
<span class="sd">                return JSONSerializer.default(self, obj)</span>

<span class="sd">        es = Elasticsearch(serializer=SetEncoder())</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hosts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">transport_class</span><span class="o">=</span><span class="n">Transport</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :arg hosts: list of nodes we should connect to. Node should be a</span>
<span class="sd">            dictionary ({&quot;host&quot;: &quot;localhost&quot;, &quot;port&quot;: 9200}), the entire dictionary</span>
<span class="sd">            will be passed to the :class:`~elasticsearch.Connection` class as</span>
<span class="sd">            kwargs, or a string in the format of ``host[:port]`` which will be</span>
<span class="sd">            translated to a dictionary automatically.  If no value is given the</span>
<span class="sd">            :class:`~elasticsearch.Urllib3HttpConnection` class defaults will be used.</span>

<span class="sd">        :arg transport_class: :class:`~elasticsearch.Transport` subclass to use.</span>

<span class="sd">        :arg kwargs: any additional arguments will be passed on to the</span>
<span class="sd">            :class:`~elasticsearch.Transport` class and, subsequently, to the</span>
<span class="sd">            :class:`~elasticsearch.Connection` instances.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transport</span> <span class="o">=</span> <span class="n">transport_class</span><span class="p">(</span><span class="n">_normalize_hosts</span><span class="p">(</span><span class="n">hosts</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># namespaced clients for compatibility with API names</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">indices</span> <span class="o">=</span> <span class="n">IndicesClient</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ingest</span> <span class="o">=</span> <span class="n">IngestClient</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cluster</span> <span class="o">=</span> <span class="n">ClusterClient</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cat</span> <span class="o">=</span> <span class="n">CatClient</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span> <span class="o">=</span> <span class="n">NodesClient</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remote</span> <span class="o">=</span> <span class="n">RemoteClient</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">snapshot</span> <span class="o">=</span> <span class="n">SnapshotClient</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tasks</span> <span class="o">=</span> <span class="n">TasksClient</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xpack</span> <span class="o">=</span> <span class="n">XPackClient</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># get a list of all connections</span>
            <span class="n">cons</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">hosts</span>
            <span class="c1"># truncate to 5 if there are too many</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cons</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
                <span class="n">cons</span> <span class="o">=</span> <span class="n">cons</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;...&quot;</span><span class="p">]</span>
            <span class="k">return</span> <span class="s2">&quot;&lt;</span><span class="si">{cls}</span><span class="s2">(</span><span class="si">{cons}</span><span class="s2">)&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">cls</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">cons</span><span class="o">=</span><span class="n">cons</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="c1"># probably operating on custom transport and connection_pool, ignore</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Elasticsearch</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_bulk_body</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">body</span><span class="p">):</span>
        <span class="c1"># if not passed in a string, serialize items and join by newline</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="n">string_types</span><span class="p">):</span>
            <span class="n">body</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">serializer</span><span class="o">.</span><span class="n">dumps</span><span class="p">,</span> <span class="n">body</span><span class="p">))</span>

        <span class="c1"># bulk body must end with a newline</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">body</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">):</span>
            <span class="n">body</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="k">return</span> <span class="n">body</span>

<div class="viewcode-block" id="Elasticsearch.ping"><a class="viewcode-back" href="../../onegov_testing.html#onegov_testing.fixtures.Elasticsearch.ping">[docs]</a>    <span class="nd">@query_params</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">ping</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns True if the cluster is up, False otherwise.</span>
<span class="sd">        `&lt;http://www.elastic.co/guide/&gt;`_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">perform_request</span><span class="p">(</span><span class="s2">&quot;HEAD&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">TransportError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="Elasticsearch.info"><a class="viewcode-back" href="../../onegov_testing.html#onegov_testing.fixtures.Elasticsearch.info">[docs]</a>    <span class="nd">@query_params</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the basic info from the current cluster.</span>
<span class="sd">        `&lt;http://www.elastic.co/guide/&gt;`_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">perform_request</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="Elasticsearch.create"><a class="viewcode-back" href="../../onegov_testing.html#onegov_testing.fixtures.Elasticsearch.create">[docs]</a>    <span class="nd">@query_params</span><span class="p">(</span>
        <span class="s2">&quot;parent&quot;</span><span class="p">,</span>
        <span class="s2">&quot;pipeline&quot;</span><span class="p">,</span>
        <span class="s2">&quot;refresh&quot;</span><span class="p">,</span>
        <span class="s2">&quot;routing&quot;</span><span class="p">,</span>
        <span class="s2">&quot;timeout&quot;</span><span class="p">,</span>
        <span class="s2">&quot;timestamp&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ttl&quot;</span><span class="p">,</span>
        <span class="s2">&quot;version&quot;</span><span class="p">,</span>
        <span class="s2">&quot;version_type&quot;</span><span class="p">,</span>
        <span class="s2">&quot;wait_for_active_shards&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">doc_type</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a typed JSON document in a specific index, making it searchable.</span>
<span class="sd">        Behind the scenes this method calls index(..., op_type=&#39;create&#39;)</span>
<span class="sd">        `&lt;http://www.elastic.co/guide/en/elasticsearch/reference/current/docs-index_.html&gt;`_</span>

<span class="sd">        :arg index: The name of the index</span>
<span class="sd">        :arg doc_type: The type of the document</span>
<span class="sd">        :arg id: Document ID</span>
<span class="sd">        :arg body: The document</span>
<span class="sd">        :arg parent: ID of the parent document</span>
<span class="sd">        :arg pipeline: The pipeline id to preprocess incoming documents with</span>
<span class="sd">        :arg refresh: If `true` then refresh the affected shards to make this</span>
<span class="sd">            operation visible to search, if `wait_for` then wait for a refresh</span>
<span class="sd">            to make this operation visible to search, if `false` (the default)</span>
<span class="sd">            then do nothing with refreshes., valid choices are: &#39;true&#39;, &#39;false&#39;,</span>
<span class="sd">            &#39;wait_for&#39;</span>
<span class="sd">        :arg routing: Specific routing value</span>
<span class="sd">        :arg timeout: Explicit operation timeout</span>
<span class="sd">        :arg timestamp: Explicit timestamp for the document</span>
<span class="sd">        :arg ttl: Expiration time for the document</span>
<span class="sd">        :arg version: Explicit version number for concurrency control</span>
<span class="sd">        :arg version_type: Specific version type, valid choices are: &#39;internal&#39;,</span>
<span class="sd">            &#39;external&#39;, &#39;external_gte&#39;, &#39;force&#39;</span>
<span class="sd">        :arg wait_for_active_shards: Sets the number of shard copies that must</span>
<span class="sd">            be active before proceeding with the index operation. Defaults to 1,</span>
<span class="sd">            meaning the primary shard only. Set to `all` for all shard copies,</span>
<span class="sd">            otherwise set to any non-negative value less than or equal to the</span>
<span class="sd">            total number of copies for the shard (number of replicas + 1)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">doc_type</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">body</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">SKIP_IN_PATH</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Empty value passed for a required argument.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">perform_request</span><span class="p">(</span>
            <span class="s2">&quot;PUT&quot;</span><span class="p">,</span> <span class="n">_make_path</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">doc_type</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="s2">&quot;_create&quot;</span><span class="p">),</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">body</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Elasticsearch.index"><a class="viewcode-back" href="../../onegov_testing.html#onegov_testing.fixtures.Elasticsearch.index">[docs]</a>    <span class="nd">@query_params</span><span class="p">(</span>
        <span class="s2">&quot;if_primary_term&quot;</span><span class="p">,</span>
        <span class="s2">&quot;if_seq_no&quot;</span><span class="p">,</span>
        <span class="s2">&quot;op_type&quot;</span><span class="p">,</span>
        <span class="s2">&quot;parent&quot;</span><span class="p">,</span>
        <span class="s2">&quot;pipeline&quot;</span><span class="p">,</span>
        <span class="s2">&quot;refresh&quot;</span><span class="p">,</span>
        <span class="s2">&quot;routing&quot;</span><span class="p">,</span>
        <span class="s2">&quot;timeout&quot;</span><span class="p">,</span>
        <span class="s2">&quot;timestamp&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ttl&quot;</span><span class="p">,</span>
        <span class="s2">&quot;version&quot;</span><span class="p">,</span>
        <span class="s2">&quot;version_type&quot;</span><span class="p">,</span>
        <span class="s2">&quot;wait_for_active_shards&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">doc_type</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds or updates a typed JSON document in a specific index, making it searchable.</span>
<span class="sd">        `&lt;http://www.elastic.co/guide/en/elasticsearch/reference/current/docs-index_.html&gt;`_</span>

<span class="sd">        :arg index: The name of the index</span>
<span class="sd">        :arg doc_type: The type of the document</span>
<span class="sd">        :arg body: The document</span>
<span class="sd">        :arg id: Document ID</span>
<span class="sd">        :arg if_primary_term: only perform the index operation if the last</span>
<span class="sd">            operation that has changed the document has the specified primary</span>
<span class="sd">            term</span>
<span class="sd">        :arg if_seq_no: only perform the index operation if the last operation</span>
<span class="sd">            that has changed the document has the specified sequence number</span>
<span class="sd">        :arg op_type: Explicit operation type, default &#39;index&#39;, valid choices</span>
<span class="sd">            are: &#39;index&#39;, &#39;create&#39;</span>
<span class="sd">        :arg parent: ID of the parent document</span>
<span class="sd">        :arg pipeline: The pipeline id to preprocess incoming documents with</span>
<span class="sd">        :arg refresh: If `true` then refresh the affected shards to make this</span>
<span class="sd">            operation visible to search, if `wait_for` then wait for a refresh</span>
<span class="sd">            to make this operation visible to search, if `false` (the default)</span>
<span class="sd">            then do nothing with refreshes., valid choices are: &#39;true&#39;, &#39;false&#39;,</span>
<span class="sd">            &#39;wait_for&#39;</span>
<span class="sd">        :arg routing: Specific routing value</span>
<span class="sd">        :arg timeout: Explicit operation timeout</span>
<span class="sd">        :arg timestamp: Explicit timestamp for the document</span>
<span class="sd">        :arg ttl: Expiration time for the document</span>
<span class="sd">        :arg version: Explicit version number for concurrency control</span>
<span class="sd">        :arg version_type: Specific version type, valid choices are: &#39;internal&#39;,</span>
<span class="sd">            &#39;external&#39;, &#39;external_gte&#39;, &#39;force&#39;</span>
<span class="sd">        :arg wait_for_active_shards: Sets the number of shard copies that must</span>
<span class="sd">            be active before proceeding with the index operation. Defaults to 1,</span>
<span class="sd">            meaning the primary shard only. Set to `all` for all shard copies,</span>
<span class="sd">            otherwise set to any non-negative value less than or equal to the</span>
<span class="sd">            total number of copies for the shard (number of replicas + 1)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">doc_type</span><span class="p">,</span> <span class="n">body</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">SKIP_IN_PATH</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Empty value passed for a required argument.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">perform_request</span><span class="p">(</span>
            <span class="s2">&quot;POST&quot;</span> <span class="k">if</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">SKIP_IN_PATH</span> <span class="k">else</span> <span class="s2">&quot;PUT&quot;</span><span class="p">,</span>
            <span class="n">_make_path</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">doc_type</span><span class="p">,</span> <span class="nb">id</span><span class="p">),</span>
            <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
            <span class="n">body</span><span class="o">=</span><span class="n">body</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Elasticsearch.exists"><a class="viewcode-back" href="../../onegov_testing.html#onegov_testing.fixtures.Elasticsearch.exists">[docs]</a>    <span class="nd">@query_params</span><span class="p">(</span>
        <span class="s2">&quot;_source&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_source_exclude&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_source_include&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_source_excludes&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_source_includes&quot;</span><span class="p">,</span>
        <span class="s2">&quot;parent&quot;</span><span class="p">,</span>
        <span class="s2">&quot;preference&quot;</span><span class="p">,</span>
        <span class="s2">&quot;realtime&quot;</span><span class="p">,</span>
        <span class="s2">&quot;refresh&quot;</span><span class="p">,</span>
        <span class="s2">&quot;routing&quot;</span><span class="p">,</span>
        <span class="s2">&quot;stored_fields&quot;</span><span class="p">,</span>
        <span class="s2">&quot;version&quot;</span><span class="p">,</span>
        <span class="s2">&quot;version_type&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="nf">exists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">doc_type</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a boolean indicating whether or not given document exists in Elasticsearch.</span>
<span class="sd">        `&lt;http://www.elastic.co/guide/en/elasticsearch/reference/current/docs-get.html&gt;`_</span>

<span class="sd">        :arg index: The name of the index</span>
<span class="sd">        :arg doc_type: The type of the document (use `_all` to fetch the first</span>
<span class="sd">            document matching the ID across all types)</span>
<span class="sd">        :arg id: The document ID</span>
<span class="sd">        :arg _source: True or false to return the _source field or not, or a</span>
<span class="sd">            list of fields to return</span>
<span class="sd">        :arg _source_exclude: A list of fields to exclude from the returned</span>
<span class="sd">            _source field</span>
<span class="sd">        :arg _source_include: A list of fields to extract and return from the</span>
<span class="sd">            _source field</span>
<span class="sd">        :arg _source_excludes: A list of fields to exclude from the returned</span>
<span class="sd">            _source field</span>
<span class="sd">        :arg _source_includes: A list of fields to extract and return from the</span>
<span class="sd">            _source field</span>
<span class="sd">        :arg parent: The ID of the parent document</span>
<span class="sd">        :arg preference: Specify the node or shard the operation should be</span>
<span class="sd">            performed on (default: random)</span>
<span class="sd">        :arg realtime: Specify whether to perform the operation in realtime or</span>
<span class="sd">            search mode</span>
<span class="sd">        :arg refresh: Refresh the shard containing the document before</span>
<span class="sd">            performing the operation</span>
<span class="sd">        :arg routing: Specific routing value</span>
<span class="sd">        :arg stored_fields: A comma-separated list of stored fields to return in</span>
<span class="sd">            the response</span>
<span class="sd">        :arg version: Explicit version number for concurrency control</span>
<span class="sd">        :arg version_type: Specific version type, valid choices are: &#39;internal&#39;,</span>
<span class="sd">            &#39;external&#39;, &#39;external_gte&#39;, &#39;force&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">doc_type</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">SKIP_IN_PATH</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Empty value passed for a required argument.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">perform_request</span><span class="p">(</span>
            <span class="s2">&quot;HEAD&quot;</span><span class="p">,</span> <span class="n">_make_path</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">doc_type</span><span class="p">,</span> <span class="nb">id</span><span class="p">),</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Elasticsearch.exists_source"><a class="viewcode-back" href="../../onegov_testing.html#onegov_testing.fixtures.Elasticsearch.exists_source">[docs]</a>    <span class="nd">@query_params</span><span class="p">(</span>
        <span class="s2">&quot;_source&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_source_exclude&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_source_include&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_source_excludes&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_source_includes&quot;</span><span class="p">,</span>
        <span class="s2">&quot;parent&quot;</span><span class="p">,</span>
        <span class="s2">&quot;preference&quot;</span><span class="p">,</span>
        <span class="s2">&quot;realtime&quot;</span><span class="p">,</span>
        <span class="s2">&quot;refresh&quot;</span><span class="p">,</span>
        <span class="s2">&quot;routing&quot;</span><span class="p">,</span>
        <span class="s2">&quot;version&quot;</span><span class="p">,</span>
        <span class="s2">&quot;version_type&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="nf">exists_source</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">doc_type</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        `&lt;http://www.elastic.co/guide/en/elasticsearch/reference/master/docs-get.html&gt;`_</span>

<span class="sd">        :arg index: The name of the index</span>
<span class="sd">        :arg doc_type: The type of the document; use `_all` to fetch the first</span>
<span class="sd">            document matching the ID across all types</span>
<span class="sd">        :arg id: The document ID</span>
<span class="sd">        :arg _source: True or false to return the _source field or not, or a</span>
<span class="sd">            list of fields to return</span>
<span class="sd">        :arg _source_exclude: A list of fields to exclude from the returned</span>
<span class="sd">            _source field</span>
<span class="sd">        :arg _source_include: A list of fields to extract and return from the</span>
<span class="sd">            _source field</span>
<span class="sd">        :arg _source_excludes: A list of fields to exclude from the returned</span>
<span class="sd">            _source field</span>
<span class="sd">        :arg _source_includes: A list of fields to extract and return from the</span>
<span class="sd">            _source field</span>
<span class="sd">        :arg parent: The ID of the parent document</span>
<span class="sd">        :arg preference: Specify the node or shard the operation should be</span>
<span class="sd">            performed on (default: random)</span>
<span class="sd">        :arg realtime: Specify whether to perform the operation in realtime or</span>
<span class="sd">            search mode</span>
<span class="sd">        :arg refresh: Refresh the shard containing the document before</span>
<span class="sd">            performing the operation</span>
<span class="sd">        :arg routing: Specific routing value</span>
<span class="sd">        :arg version: Explicit version number for concurrency control</span>
<span class="sd">        :arg version_type: Specific version type, valid choices are: &#39;internal&#39;,</span>
<span class="sd">            &#39;external&#39;, &#39;external_gte&#39;, &#39;force&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">doc_type</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">SKIP_IN_PATH</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Empty value passed for a required argument.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">perform_request</span><span class="p">(</span>
            <span class="s2">&quot;HEAD&quot;</span><span class="p">,</span> <span class="n">_make_path</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">doc_type</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="s2">&quot;_source&quot;</span><span class="p">),</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Elasticsearch.get"><a class="viewcode-back" href="../../onegov_testing.html#onegov_testing.fixtures.Elasticsearch.get">[docs]</a>    <span class="nd">@query_params</span><span class="p">(</span>
        <span class="s2">&quot;_source&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_source_exclude&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_source_include&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_source_excludes&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_source_includes&quot;</span><span class="p">,</span>
        <span class="s2">&quot;parent&quot;</span><span class="p">,</span>
        <span class="s2">&quot;preference&quot;</span><span class="p">,</span>
        <span class="s2">&quot;realtime&quot;</span><span class="p">,</span>
        <span class="s2">&quot;refresh&quot;</span><span class="p">,</span>
        <span class="s2">&quot;routing&quot;</span><span class="p">,</span>
        <span class="s2">&quot;stored_fields&quot;</span><span class="p">,</span>
        <span class="s2">&quot;version&quot;</span><span class="p">,</span>
        <span class="s2">&quot;version_type&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">doc_type</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get a typed JSON document from the index based on its id.</span>
<span class="sd">        `&lt;http://www.elastic.co/guide/en/elasticsearch/reference/current/docs-get.html&gt;`_</span>

<span class="sd">        :arg index: The name of the index</span>
<span class="sd">        :arg doc_type: The type of the document (use `_all` to fetch the first</span>
<span class="sd">            document matching the ID across all types)</span>
<span class="sd">        :arg id: The document ID</span>
<span class="sd">        :arg _source: True or false to return the _source field or not, or a</span>
<span class="sd">            list of fields to return</span>
<span class="sd">        :arg _source_exclude: A list of fields to exclude from the returned</span>
<span class="sd">            _source field</span>
<span class="sd">        :arg _source_include: A list of fields to extract and return from the</span>
<span class="sd">            _source field</span>
<span class="sd">        :arg _source_excludes: A list of fields to exclude from the returned</span>
<span class="sd">            _source field</span>
<span class="sd">        :arg _source_includes: A list of fields to extract and return from the</span>
<span class="sd">            _source field</span>
<span class="sd">        :arg parent: The ID of the parent document</span>
<span class="sd">        :arg preference: Specify the node or shard the operation should be</span>
<span class="sd">            performed on (default: random)</span>
<span class="sd">        :arg realtime: Specify whether to perform the operation in realtime or</span>
<span class="sd">            search mode</span>
<span class="sd">        :arg refresh: Refresh the shard containing the document before</span>
<span class="sd">            performing the operation</span>
<span class="sd">        :arg routing: Specific routing value</span>
<span class="sd">        :arg stored_fields: A comma-separated list of stored fields to return in</span>
<span class="sd">            the response</span>
<span class="sd">        :arg version: Explicit version number for concurrency control</span>
<span class="sd">        :arg version_type: Specific version type, valid choices are: &#39;internal&#39;,</span>
<span class="sd">            &#39;external&#39;, &#39;external_gte&#39;, &#39;force&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">doc_type</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">SKIP_IN_PATH</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Empty value passed for a required argument.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">perform_request</span><span class="p">(</span>
            <span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">_make_path</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">doc_type</span><span class="p">,</span> <span class="nb">id</span><span class="p">),</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Elasticsearch.get_source"><a class="viewcode-back" href="../../onegov_testing.html#onegov_testing.fixtures.Elasticsearch.get_source">[docs]</a>    <span class="nd">@query_params</span><span class="p">(</span>
        <span class="s2">&quot;_source&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_source_exclude&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_source_include&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_source_excludes&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_source_includes&quot;</span><span class="p">,</span>
        <span class="s2">&quot;parent&quot;</span><span class="p">,</span>
        <span class="s2">&quot;preference&quot;</span><span class="p">,</span>
        <span class="s2">&quot;realtime&quot;</span><span class="p">,</span>
        <span class="s2">&quot;refresh&quot;</span><span class="p">,</span>
        <span class="s2">&quot;routing&quot;</span><span class="p">,</span>
        <span class="s2">&quot;version&quot;</span><span class="p">,</span>
        <span class="s2">&quot;version_type&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="nf">get_source</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">doc_type</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the source of a document by it&#39;s index, type and id.</span>
<span class="sd">        `&lt;http://www.elastic.co/guide/en/elasticsearch/reference/current/docs-get.html&gt;`_</span>

<span class="sd">        :arg index: The name of the index</span>
<span class="sd">        :arg doc_type: The type of the document; use `_all` to fetch the first</span>
<span class="sd">            document matching the ID across all types</span>
<span class="sd">        :arg id: The document ID</span>
<span class="sd">        :arg _source: True or false to return the _source field or not, or a</span>
<span class="sd">            list of fields to return</span>
<span class="sd">        :arg _source_exclude: A list of fields to exclude from the returned</span>
<span class="sd">            _source field</span>
<span class="sd">        :arg _source_include: A list of fields to extract and return from the</span>
<span class="sd">            _source field</span>
<span class="sd">        :arg _source_excludes: A list of fields to exclude from the returned</span>
<span class="sd">            _source field</span>
<span class="sd">        :arg _source_includes: A list of fields to extract and return from the</span>
<span class="sd">            _source field</span>
<span class="sd">        :arg parent: The ID of the parent document</span>
<span class="sd">        :arg preference: Specify the node or shard the operation should be</span>
<span class="sd">            performed on (default: random)</span>
<span class="sd">        :arg realtime: Specify whether to perform the operation in realtime or</span>
<span class="sd">            search mode</span>
<span class="sd">        :arg refresh: Refresh the shard containing the document before</span>
<span class="sd">            performing the operation</span>
<span class="sd">        :arg routing: Specific routing value</span>
<span class="sd">        :arg version: Explicit version number for concurrency control</span>
<span class="sd">        :arg version_type: Specific version type, valid choices are: &#39;internal&#39;,</span>
<span class="sd">            &#39;external&#39;, &#39;external_gte&#39;, &#39;force&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">doc_type</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">SKIP_IN_PATH</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Empty value passed for a required argument.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">perform_request</span><span class="p">(</span>
            <span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">_make_path</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">doc_type</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="s2">&quot;_source&quot;</span><span class="p">),</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Elasticsearch.mget"><a class="viewcode-back" href="../../onegov_testing.html#onegov_testing.fixtures.Elasticsearch.mget">[docs]</a>    <span class="nd">@query_params</span><span class="p">(</span>
        <span class="s2">&quot;_source&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_source_exclude&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_source_include&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_source_excludes&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_source_includes&quot;</span><span class="p">,</span>
        <span class="s2">&quot;preference&quot;</span><span class="p">,</span>
        <span class="s2">&quot;realtime&quot;</span><span class="p">,</span>
        <span class="s2">&quot;refresh&quot;</span><span class="p">,</span>
        <span class="s2">&quot;routing&quot;</span><span class="p">,</span>
        <span class="s2">&quot;stored_fields&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="nf">mget</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">doc_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get multiple documents based on an index, type (optional) and ids.</span>
<span class="sd">        `&lt;http://www.elastic.co/guide/en/elasticsearch/reference/current/docs-multi-get.html&gt;`_</span>

<span class="sd">        :arg body: Document identifiers; can be either `docs` (containing full</span>
<span class="sd">            document information) or `ids` (when index and type is provided in</span>
<span class="sd">            the URL.</span>
<span class="sd">        :arg index: The name of the index</span>
<span class="sd">        :arg doc_type: The type of the document</span>
<span class="sd">        :arg _source: True or false to return the _source field or not, or a</span>
<span class="sd">            list of fields to return</span>
<span class="sd">        :arg _source_exclude: A list of fields to exclude from the returned</span>
<span class="sd">            _source field</span>
<span class="sd">        :arg _source_include: A list of fields to extract and return from the</span>
<span class="sd">            _source field</span>
<span class="sd">        :arg _source_excludes: A list of fields to exclude from the returned</span>
<span class="sd">            _source field</span>
<span class="sd">        :arg _source_includes: A list of fields to extract and return from the</span>
<span class="sd">            _source field</span>
<span class="sd">        :arg preference: Specify the node or shard the operation should be</span>
<span class="sd">            performed on (default: random)</span>
<span class="sd">        :arg realtime: Specify whether to perform the operation in realtime or</span>
<span class="sd">            search mode</span>
<span class="sd">        :arg refresh: Refresh the shard containing the document before</span>
<span class="sd">            performing the operation</span>
<span class="sd">        :arg routing: Specific routing value</span>
<span class="sd">        :arg stored_fields: A comma-separated list of stored fields to return in</span>
<span class="sd">            the response</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">body</span> <span class="ow">in</span> <span class="n">SKIP_IN_PATH</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Empty value passed for a required argument &#39;body&#39;.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">perform_request</span><span class="p">(</span>
            <span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">_make_path</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">doc_type</span><span class="p">,</span> <span class="s2">&quot;_mget&quot;</span><span class="p">),</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">body</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Elasticsearch.update"><a class="viewcode-back" href="../../onegov_testing.html#onegov_testing.fixtures.Elasticsearch.update">[docs]</a>    <span class="nd">@query_params</span><span class="p">(</span>
        <span class="s2">&quot;_source&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_source_exclude&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_source_include&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_source_excludes&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_source_includes&quot;</span><span class="p">,</span>
        <span class="s2">&quot;if_primary_term&quot;</span><span class="p">,</span>
        <span class="s2">&quot;if_seq_no&quot;</span><span class="p">,</span>
        <span class="s2">&quot;fields&quot;</span><span class="p">,</span>
        <span class="s2">&quot;lang&quot;</span><span class="p">,</span>
        <span class="s2">&quot;parent&quot;</span><span class="p">,</span>
        <span class="s2">&quot;refresh&quot;</span><span class="p">,</span>
        <span class="s2">&quot;retry_on_conflict&quot;</span><span class="p">,</span>
        <span class="s2">&quot;routing&quot;</span><span class="p">,</span>
        <span class="s2">&quot;timeout&quot;</span><span class="p">,</span>
        <span class="s2">&quot;timestamp&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ttl&quot;</span><span class="p">,</span>
        <span class="s2">&quot;version&quot;</span><span class="p">,</span>
        <span class="s2">&quot;version_type&quot;</span><span class="p">,</span>
        <span class="s2">&quot;wait_for_active_shards&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">doc_type</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update a document based on a script or partial data provided.</span>
<span class="sd">        `&lt;http://www.elastic.co/guide/en/elasticsearch/reference/current/docs-update.html&gt;`_</span>

<span class="sd">        :arg index: The name of the index</span>
<span class="sd">        :arg doc_type: The type of the document</span>
<span class="sd">        :arg id: Document ID</span>
<span class="sd">        :arg body: The request definition using either `script` or partial `doc`</span>
<span class="sd">        :arg _source: True or false to return the _source field or not, or a</span>
<span class="sd">            list of fields to return</span>
<span class="sd">        :arg _source_exclude: A list of fields to exclude from the returned</span>
<span class="sd">            _source field</span>
<span class="sd">        :arg _source_include: A list of fields to extract and return from the</span>
<span class="sd">            _source field</span>
<span class="sd">        :arg _source_excludes: A list of fields to exclude from the returned</span>
<span class="sd">            _source field</span>
<span class="sd">        :arg _source_includes: A list of fields to extract and return from the</span>
<span class="sd">            _source field</span>
<span class="sd">        :arg if_primary_term: only perform the update operation if the last</span>
<span class="sd">            operation that has changed the document has the specified primary</span>
<span class="sd">            term</span>
<span class="sd">        :arg if_seq_no: only perform the update operation if the last operation</span>
<span class="sd">            that has changed the document has the specified sequence number</span>
<span class="sd">        :arg fields: A comma-separated list of fields to return in the response</span>
<span class="sd">        :arg lang: The script language (default: painless)</span>
<span class="sd">        :arg parent: ID of the parent document. Is is only used for routing and</span>
<span class="sd">            when for the upsert request</span>
<span class="sd">        :arg refresh: If `true` then refresh the effected shards to make this</span>
<span class="sd">            operation visible to search, if `wait_for` then wait for a refresh</span>
<span class="sd">            to make this operation visible to search, if `false` (the default)</span>
<span class="sd">            then do nothing with refreshes., valid choices are: &#39;true&#39;, &#39;false&#39;,</span>
<span class="sd">            &#39;wait_for&#39;</span>
<span class="sd">        :arg retry_on_conflict: Specify how many times should the operation be</span>
<span class="sd">            retried when a conflict occurs (default: 0)</span>
<span class="sd">        :arg routing: Specific routing value</span>
<span class="sd">        :arg timeout: Explicit operation timeout</span>
<span class="sd">        :arg timestamp: Explicit timestamp for the document</span>
<span class="sd">        :arg ttl: Expiration time for the document</span>
<span class="sd">        :arg version: Explicit version number for concurrency control</span>
<span class="sd">        :arg version_type: Specific version type, valid choices are: &#39;internal&#39;,</span>
<span class="sd">            &#39;force&#39;</span>
<span class="sd">        :arg wait_for_active_shards: Sets the number of shard copies that must</span>
<span class="sd">            be active before proceeding with the update operation. Defaults to</span>
<span class="sd">            1, meaning the primary shard only. Set to `all` for all shard</span>
<span class="sd">            copies, otherwise set to any non-negative value less than or equal</span>
<span class="sd">            to the total number of copies for the shard (number of replicas + 1)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">doc_type</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">SKIP_IN_PATH</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Empty value passed for a required argument.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">perform_request</span><span class="p">(</span>
            <span class="s2">&quot;POST&quot;</span><span class="p">,</span> <span class="n">_make_path</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">doc_type</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="s2">&quot;_update&quot;</span><span class="p">),</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">body</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Elasticsearch.search"><a class="viewcode-back" href="../../onegov_testing.html#onegov_testing.fixtures.Elasticsearch.search">[docs]</a>    <span class="nd">@query_params</span><span class="p">(</span>
        <span class="s2">&quot;_source&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_source_exclude&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_source_include&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_source_excludes&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_source_includes&quot;</span><span class="p">,</span>
        <span class="s2">&quot;allow_no_indices&quot;</span><span class="p">,</span>
        <span class="s2">&quot;allow_partial_search_results&quot;</span><span class="p">,</span>
        <span class="s2">&quot;analyze_wildcard&quot;</span><span class="p">,</span>
        <span class="s2">&quot;analyzer&quot;</span><span class="p">,</span>
        <span class="s2">&quot;batched_reduce_size&quot;</span><span class="p">,</span>
        <span class="s2">&quot;default_operator&quot;</span><span class="p">,</span>
        <span class="s2">&quot;df&quot;</span><span class="p">,</span>
        <span class="s2">&quot;docvalue_fields&quot;</span><span class="p">,</span>
        <span class="s2">&quot;expand_wildcards&quot;</span><span class="p">,</span>
        <span class="s2">&quot;explain&quot;</span><span class="p">,</span>
        <span class="s2">&quot;from_&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ignore_throttled&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ignore_unavailable&quot;</span><span class="p">,</span>
        <span class="s2">&quot;lenient&quot;</span><span class="p">,</span>
        <span class="s2">&quot;max_concurrent_shard_requests&quot;</span><span class="p">,</span>
        <span class="s2">&quot;pre_filter_shard_size&quot;</span><span class="p">,</span>
        <span class="s2">&quot;preference&quot;</span><span class="p">,</span>
        <span class="s2">&quot;q&quot;</span><span class="p">,</span>
        <span class="s2">&quot;request_cache&quot;</span><span class="p">,</span>
        <span class="s2">&quot;routing&quot;</span><span class="p">,</span>
        <span class="s2">&quot;scroll&quot;</span><span class="p">,</span>
        <span class="s2">&quot;search_type&quot;</span><span class="p">,</span>
        <span class="s2">&quot;size&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sort&quot;</span><span class="p">,</span>
        <span class="s2">&quot;stats&quot;</span><span class="p">,</span>
        <span class="s2">&quot;stored_fields&quot;</span><span class="p">,</span>
        <span class="s2">&quot;suggest_field&quot;</span><span class="p">,</span>
        <span class="s2">&quot;suggest_mode&quot;</span><span class="p">,</span>
        <span class="s2">&quot;suggest_size&quot;</span><span class="p">,</span>
        <span class="s2">&quot;suggest_text&quot;</span><span class="p">,</span>
        <span class="s2">&quot;terminate_after&quot;</span><span class="p">,</span>
        <span class="s2">&quot;timeout&quot;</span><span class="p">,</span>
        <span class="s2">&quot;track_scores&quot;</span><span class="p">,</span>
        <span class="s2">&quot;track_total_hits&quot;</span><span class="p">,</span>
        <span class="s2">&quot;typed_keys&quot;</span><span class="p">,</span>
        <span class="s2">&quot;version&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="nf">search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">doc_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Execute a search query and get back search hits that match the query.</span>
<span class="sd">        `&lt;http://www.elastic.co/guide/en/elasticsearch/reference/current/search-search.html&gt;`_</span>

<span class="sd">        :arg index: A comma-separated list of index names to search; use `_all`</span>
<span class="sd">            or empty string to perform the operation on all indices</span>
<span class="sd">        :arg doc_type: A comma-separated list of document types to search; leave</span>
<span class="sd">            empty to perform the operation on all types</span>
<span class="sd">        :arg body: The search definition using the Query DSL</span>
<span class="sd">        :arg _source: True or false to return the _source field or not, or a</span>
<span class="sd">            list of fields to return</span>
<span class="sd">        :arg _source_exclude: A list of fields to exclude from the returned</span>
<span class="sd">            _source field</span>
<span class="sd">        :arg _source_include: A list of fields to extract and return from the</span>
<span class="sd">            _source field</span>
<span class="sd">        :arg _source_excludes: A list of fields to exclude from the returned</span>
<span class="sd">            _source field</span>
<span class="sd">        :arg _source_includes: A list of fields to extract and return from the</span>
<span class="sd">            _source field</span>
<span class="sd">        :arg allow_no_indices: Whether to ignore if a wildcard indices</span>
<span class="sd">            expression resolves into no concrete indices. (This includes `_all`</span>
<span class="sd">            string or when no indices have been specified)</span>
<span class="sd">        :arg allow_partial_search_results: Set to false to return an overall</span>
<span class="sd">            failure if the request would produce partial results. Defaults to</span>
<span class="sd">            True, which will allow partial results in the case of timeouts or</span>
<span class="sd">            partial failures</span>
<span class="sd">        :arg analyze_wildcard: Specify whether wildcard and prefix queries</span>
<span class="sd">            should be analyzed (default: false)</span>
<span class="sd">        :arg analyzer: The analyzer to use for the query string</span>
<span class="sd">        :arg batched_reduce_size: The number of shard results that should be</span>
<span class="sd">            reduced at once on the coordinating node. This value should be used</span>
<span class="sd">            as a protection mechanism to reduce the memory overhead per search</span>
<span class="sd">            request if the potential number of shards in the request can be</span>
<span class="sd">            large., default 512</span>
<span class="sd">        :arg default_operator: The default operator for query string query (AND</span>
<span class="sd">            or OR), default &#39;OR&#39;, valid choices are: &#39;AND&#39;, &#39;OR&#39;</span>
<span class="sd">        :arg df: The field to use as default where no field prefix is given in</span>
<span class="sd">            the query string</span>
<span class="sd">        :arg docvalue_fields: A comma-separated list of fields to return as the</span>
<span class="sd">            docvalue representation of a field for each hit</span>
<span class="sd">        :arg expand_wildcards: Whether to expand wildcard expression to concrete</span>
<span class="sd">            indices that are open, closed or both., default &#39;open&#39;, valid</span>
<span class="sd">            choices are: &#39;open&#39;, &#39;closed&#39;, &#39;none&#39;, &#39;all&#39;</span>
<span class="sd">        :arg explain: Specify whether to return detailed information about score</span>
<span class="sd">            computation as part of a hit</span>
<span class="sd">        :arg from\\_: Starting offset (default: 0)</span>
<span class="sd">        :arg ignore_throttled: Whether specified concrete, expanded or aliased</span>
<span class="sd">            indices should be ignored when throttled</span>
<span class="sd">        :arg ignore_unavailable: Whether specified concrete indices should be</span>
<span class="sd">            ignored when unavailable (missing or closed)</span>
<span class="sd">        :arg lenient: Specify whether format-based query failures (such as</span>
<span class="sd">            providing text to a numeric field) should be ignored</span>
<span class="sd">        :arg max_concurrent_shard_requests: The number of concurrent shard</span>
<span class="sd">            requests this search executes concurrently. This value should be</span>
<span class="sd">            used to limit the impact of the search on the cluster in order to</span>
<span class="sd">            limit the number of concurrent shard requests, default &#39;The default</span>
<span class="sd">            grows with the number of nodes in the cluster but is at most 256.&#39;</span>
<span class="sd">        :arg pre_filter_shard_size: A threshold that enforces a pre-filter</span>
<span class="sd">            roundtrip to prefilter search shards based on query rewriting if</span>
<span class="sd">            the number of shards the search request expands to exceeds the</span>
<span class="sd">            threshold. This filter roundtrip can limit the number of shards</span>
<span class="sd">            significantly if for instance a shard can not match any documents</span>
<span class="sd">            based on it&#39;s rewrite method ie. if date filters are mandatory to</span>
<span class="sd">            match but the shard bounds and the query are disjoint., default 128</span>
<span class="sd">        :arg preference: Specify the node or shard the operation should be</span>
<span class="sd">            performed on (default: random)</span>
<span class="sd">        :arg q: Query in the Lucene query string syntax</span>
<span class="sd">        :arg request_cache: Specify if request cache should be used for this</span>
<span class="sd">            request or not, defaults to index level setting</span>
<span class="sd">        :arg routing: A comma-separated list of specific routing values</span>
<span class="sd">        :arg scroll: Specify how long a consistent view of the index should be</span>
<span class="sd">            maintained for scrolled search</span>
<span class="sd">        :arg search_type: Search operation type, valid choices are:</span>
<span class="sd">            &#39;query_then_fetch&#39;, &#39;dfs_query_then_fetch&#39;</span>
<span class="sd">        :arg size: Number of hits to return (default: 10)</span>
<span class="sd">        :arg sort: A comma-separated list of &lt;field&gt;:&lt;direction&gt; pairs</span>
<span class="sd">        :arg stats: Specific &#39;tag&#39; of the request for logging and statistical</span>
<span class="sd">            purposes</span>
<span class="sd">        :arg stored_fields: A comma-separated list of stored fields to return as</span>
<span class="sd">            part of a hit</span>
<span class="sd">        :arg suggest_field: Specify which field to use for suggestions</span>
<span class="sd">        :arg suggest_mode: Specify suggest mode, default &#39;missing&#39;, valid</span>
<span class="sd">            choices are: &#39;missing&#39;, &#39;popular&#39;, &#39;always&#39;</span>
<span class="sd">        :arg suggest_size: How many suggestions to return in response</span>
<span class="sd">        :arg suggest_text: The source text for which the suggestions should be</span>
<span class="sd">            returned</span>
<span class="sd">        :arg terminate_after: The maximum number of documents to collect for</span>
<span class="sd">            each shard, upon reaching which the query execution will terminate</span>
<span class="sd">            early.</span>
<span class="sd">        :arg timeout: Explicit operation timeout</span>
<span class="sd">        :arg track_scores: Whether to calculate and return scores even if they</span>
<span class="sd">            are not used for sorting</span>
<span class="sd">        :arg track_total_hits: Indicate if the number of documents that match</span>
<span class="sd">            the query should be tracked</span>
<span class="sd">        :arg typed_keys: Specify whether aggregation and suggester names should</span>
<span class="sd">            be prefixed by their respective types in the response</span>
<span class="sd">        :arg version: Specify whether to return document version as part of a</span>
<span class="sd">            hit</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># from is a reserved word so it cannot be used, use from_ instead</span>
        <span class="k">if</span> <span class="s2">&quot;from_&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;from&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;from_&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">doc_type</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">index</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="s2">&quot;_all&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">perform_request</span><span class="p">(</span>
            <span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">_make_path</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">doc_type</span><span class="p">,</span> <span class="s2">&quot;_search&quot;</span><span class="p">),</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">body</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Elasticsearch.update_by_query"><a class="viewcode-back" href="../../onegov_testing.html#onegov_testing.fixtures.Elasticsearch.update_by_query">[docs]</a>    <span class="nd">@query_params</span><span class="p">(</span>
        <span class="s2">&quot;_source&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_source_exclude&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_source_include&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_source_excludes&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_source_includes&quot;</span><span class="p">,</span>
        <span class="s2">&quot;allow_no_indices&quot;</span><span class="p">,</span>
        <span class="s2">&quot;analyze_wildcard&quot;</span><span class="p">,</span>
        <span class="s2">&quot;analyzer&quot;</span><span class="p">,</span>
        <span class="s2">&quot;conflicts&quot;</span><span class="p">,</span>
        <span class="s2">&quot;default_operator&quot;</span><span class="p">,</span>
        <span class="s2">&quot;df&quot;</span><span class="p">,</span>
        <span class="s2">&quot;expand_wildcards&quot;</span><span class="p">,</span>
        <span class="s2">&quot;from_&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ignore_unavailable&quot;</span><span class="p">,</span>
        <span class="s2">&quot;lenient&quot;</span><span class="p">,</span>
        <span class="s2">&quot;pipeline&quot;</span><span class="p">,</span>
        <span class="s2">&quot;preference&quot;</span><span class="p">,</span>
        <span class="s2">&quot;q&quot;</span><span class="p">,</span>
        <span class="s2">&quot;refresh&quot;</span><span class="p">,</span>
        <span class="s2">&quot;request_cache&quot;</span><span class="p">,</span>
        <span class="s2">&quot;requests_per_second&quot;</span><span class="p">,</span>
        <span class="s2">&quot;routing&quot;</span><span class="p">,</span>
        <span class="s2">&quot;scroll&quot;</span><span class="p">,</span>
        <span class="s2">&quot;scroll_size&quot;</span><span class="p">,</span>
        <span class="s2">&quot;search_timeout&quot;</span><span class="p">,</span>
        <span class="s2">&quot;search_type&quot;</span><span class="p">,</span>
        <span class="s2">&quot;size&quot;</span><span class="p">,</span>
        <span class="s2">&quot;slices&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sort&quot;</span><span class="p">,</span>
        <span class="s2">&quot;stats&quot;</span><span class="p">,</span>
        <span class="s2">&quot;terminate_after&quot;</span><span class="p">,</span>
        <span class="s2">&quot;timeout&quot;</span><span class="p">,</span>
        <span class="s2">&quot;version&quot;</span><span class="p">,</span>
        <span class="s2">&quot;version_type&quot;</span><span class="p">,</span>
        <span class="s2">&quot;wait_for_active_shards&quot;</span><span class="p">,</span>
        <span class="s2">&quot;wait_for_completion&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="nf">update_by_query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">doc_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Perform an update on all documents matching a query.</span>
<span class="sd">        `&lt;https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-update-by-query.html&gt;`_</span>

<span class="sd">        :arg index: A comma-separated list of index names to search; use `_all`</span>
<span class="sd">            or empty string to perform the operation on all indices</span>
<span class="sd">        :arg doc_type: A comma-separated list of document types to search; leave</span>
<span class="sd">            empty to perform the operation on all types</span>
<span class="sd">        :arg body: The search definition using the Query DSL</span>
<span class="sd">        :arg _source: True or false to return the _source field or not, or a</span>
<span class="sd">            list of fields to return</span>
<span class="sd">        :arg _source_exclude: A list of fields to exclude from the returned</span>
<span class="sd">            _source field</span>
<span class="sd">        :arg _source_include: A list of fields to extract and return from the</span>
<span class="sd">            _source field</span>
<span class="sd">        :arg _source_excludes: A list of fields to exclude from the returned</span>
<span class="sd">            _source field</span>
<span class="sd">        :arg _source_includes: A list of fields to extract and return from the</span>
<span class="sd">            _source field</span>
<span class="sd">        :arg allow_no_indices: Whether to ignore if a wildcard indices</span>
<span class="sd">            expression resolves into no concrete indices. (This includes `_all`</span>
<span class="sd">            string or when no indices have been specified)</span>
<span class="sd">        :arg analyze_wildcard: Specify whether wildcard and prefix queries</span>
<span class="sd">            should be analyzed (default: false)</span>
<span class="sd">        :arg analyzer: The analyzer to use for the query string</span>
<span class="sd">        :arg conflicts: What to do when the update by query hits version</span>
<span class="sd">            conflicts?, default &#39;abort&#39;, valid choices are: &#39;abort&#39;, &#39;proceed&#39;</span>
<span class="sd">        :arg default_operator: The default operator for query string query (AND</span>
<span class="sd">            or OR), default &#39;OR&#39;, valid choices are: &#39;AND&#39;, &#39;OR&#39;</span>
<span class="sd">        :arg df: The field to use as default where no field prefix is given in</span>
<span class="sd">            the query string</span>
<span class="sd">        :arg expand_wildcards: Whether to expand wildcard expression to concrete</span>
<span class="sd">            indices that are open, closed or both., default &#39;open&#39;, valid</span>
<span class="sd">            choices are: &#39;open&#39;, &#39;closed&#39;, &#39;none&#39;, &#39;all&#39;</span>
<span class="sd">        :arg from\\_: Starting offset (default: 0)</span>
<span class="sd">        :arg ignore_unavailable: Whether specified concrete indices should be</span>
<span class="sd">            ignored when unavailable (missing or closed)</span>
<span class="sd">        :arg lenient: Specify whether format-based query failures (such as</span>
<span class="sd">            providing text to a numeric field) should be ignored</span>
<span class="sd">        :arg pipeline: Ingest pipeline to set on index requests made by this</span>
<span class="sd">            action. (default: none)</span>
<span class="sd">        :arg preference: Specify the node or shard the operation should be</span>
<span class="sd">            performed on (default: random)</span>
<span class="sd">        :arg q: Query in the Lucene query string syntax</span>
<span class="sd">        :arg refresh: Should the effected indexes be refreshed?</span>
<span class="sd">        :arg request_cache: Specify if request cache should be used for this</span>
<span class="sd">            request or not, defaults to index level setting</span>
<span class="sd">        :arg requests_per_second: The throttle to set on this request in sub-</span>
<span class="sd">            requests per second. -1 means no throttle., default 0</span>
<span class="sd">        :arg routing: A comma-separated list of specific routing values</span>
<span class="sd">        :arg scroll: Specify how long a consistent view of the index should be</span>
<span class="sd">            maintained for scrolled search</span>
<span class="sd">        :arg scroll_size: Size on the scroll request powering the</span>
<span class="sd">            update_by_query</span>
<span class="sd">        :arg search_timeout: Explicit timeout for each search request. Defaults</span>
<span class="sd">            to no timeout.</span>
<span class="sd">        :arg search_type: Search operation type, valid choices are:</span>
<span class="sd">            &#39;query_then_fetch&#39;, &#39;dfs_query_then_fetch&#39;</span>
<span class="sd">        :arg size: Number of hits to return (default: 10)</span>
<span class="sd">        :arg slices: The number of slices this task should be divided into.</span>
<span class="sd">            Defaults to 1 meaning the task isn&#39;t sliced into subtasks., default</span>
<span class="sd">            1</span>
<span class="sd">        :arg sort: A comma-separated list of &lt;field&gt;:&lt;direction&gt; pairs</span>
<span class="sd">        :arg stats: Specific &#39;tag&#39; of the request for logging and statistical</span>
<span class="sd">            purposes</span>
<span class="sd">        :arg terminate_after: The maximum number of documents to collect for</span>
<span class="sd">            each shard, upon reaching which the query execution will terminate</span>
<span class="sd">            early.</span>
<span class="sd">        :arg timeout: Time each individual bulk request should wait for shards</span>
<span class="sd">            that are unavailable., default &#39;1m&#39;</span>
<span class="sd">        :arg version: Specify whether to return document version as part of a</span>
<span class="sd">            hit</span>
<span class="sd">        :arg version_type: Should the document increment the version number</span>
<span class="sd">            (internal) on hit or not (reindex)</span>
<span class="sd">        :arg wait_for_active_shards: Sets the number of shard copies that must</span>
<span class="sd">            be active before proceeding with the update by query operation.</span>
<span class="sd">            Defaults to 1, meaning the primary shard only. Set to `all` for all</span>
<span class="sd">            shard copies, otherwise set to any non-negative value less than or</span>
<span class="sd">            equal to the total number of copies for the shard (number of</span>
<span class="sd">            replicas + 1)</span>
<span class="sd">        :arg wait_for_completion: Should the request should block until the</span>
<span class="sd">            update by query operation is complete., default True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">SKIP_IN_PATH</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Empty value passed for a required argument &#39;index&#39;.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">perform_request</span><span class="p">(</span>
            <span class="s2">&quot;POST&quot;</span><span class="p">,</span>
            <span class="n">_make_path</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">doc_type</span><span class="p">,</span> <span class="s2">&quot;_update_by_query&quot;</span><span class="p">),</span>
            <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
            <span class="n">body</span><span class="o">=</span><span class="n">body</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Elasticsearch.update_by_query_rethrottle"><a class="viewcode-back" href="../../onegov_testing.html#onegov_testing.fixtures.Elasticsearch.update_by_query_rethrottle">[docs]</a>    <span class="nd">@query_params</span><span class="p">(</span><span class="s2">&quot;requests_per_second&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">update_by_query_rethrottle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_id</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        `&lt;https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-update-by-query.html&gt;`_</span>

<span class="sd">        :arg task_id: The task id to rethrottle</span>
<span class="sd">        :arg requests_per_second: The throttle to set on this request in</span>
<span class="sd">            floating sub-requests per second. -1 means set no throttle.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">task_id</span> <span class="ow">in</span> <span class="n">SKIP_IN_PATH</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Empty value passed for a required argument &#39;task_id&#39;.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">perform_request</span><span class="p">(</span>
            <span class="s2">&quot;POST&quot;</span><span class="p">,</span>
            <span class="n">_make_path</span><span class="p">(</span><span class="s2">&quot;_update_by_query&quot;</span><span class="p">,</span> <span class="n">task_id</span><span class="p">,</span> <span class="s2">&quot;_rethrottle&quot;</span><span class="p">),</span>
            <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Elasticsearch.reindex"><a class="viewcode-back" href="../../onegov_testing.html#onegov_testing.fixtures.Elasticsearch.reindex">[docs]</a>    <span class="nd">@query_params</span><span class="p">(</span>
        <span class="s2">&quot;refresh&quot;</span><span class="p">,</span>
        <span class="s2">&quot;requests_per_second&quot;</span><span class="p">,</span>
        <span class="s2">&quot;slices&quot;</span><span class="p">,</span>
        <span class="s2">&quot;timeout&quot;</span><span class="p">,</span>
        <span class="s2">&quot;wait_for_active_shards&quot;</span><span class="p">,</span>
        <span class="s2">&quot;wait_for_completion&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="nf">reindex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reindex all documents from one index to another.</span>
<span class="sd">        `&lt;https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-reindex.html&gt;`_</span>

<span class="sd">        :arg body: The search definition using the Query DSL and the prototype</span>
<span class="sd">            for the index request.</span>
<span class="sd">        :arg refresh: Should the effected indexes be refreshed?</span>
<span class="sd">        :arg requests_per_second: The throttle to set on this request in sub-</span>
<span class="sd">            requests per second. -1 means no throttle., default 0</span>
<span class="sd">        :arg slices: The number of slices this task should be divided into.</span>
<span class="sd">            Defaults to 1 meaning the task isn&#39;t sliced into subtasks., default</span>
<span class="sd">            1</span>
<span class="sd">        :arg timeout: Time each individual bulk request should wait for shards</span>
<span class="sd">            that are unavailable., default &#39;1m&#39;</span>
<span class="sd">        :arg wait_for_active_shards: Sets the number of shard copies that must</span>
<span class="sd">            be active before proceeding with the reindex operation. Defaults to</span>
<span class="sd">            1, meaning the primary shard only. Set to `all` for all shard</span>
<span class="sd">            copies, otherwise set to any non-negative value less than or equal</span>
<span class="sd">            to the total number of copies for the shard (number of replicas + 1)</span>
<span class="sd">        :arg wait_for_completion: Should the request should block until the</span>
<span class="sd">            reindex is complete., default True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">body</span> <span class="ow">in</span> <span class="n">SKIP_IN_PATH</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Empty value passed for a required argument &#39;body&#39;.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">perform_request</span><span class="p">(</span>
            <span class="s2">&quot;POST&quot;</span><span class="p">,</span> <span class="s2">&quot;/_reindex&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">body</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Elasticsearch.reindex_rethrottle"><a class="viewcode-back" href="../../onegov_testing.html#onegov_testing.fixtures.Elasticsearch.reindex_rethrottle">[docs]</a>    <span class="nd">@query_params</span><span class="p">(</span><span class="s2">&quot;requests_per_second&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">reindex_rethrottle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Change the value of ``requests_per_second`` of a running ``reindex`` task.</span>
<span class="sd">        `&lt;https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-reindex.html&gt;`_</span>

<span class="sd">        :arg task_id: The task id to rethrottle</span>
<span class="sd">        :arg requests_per_second: The throttle to set on this request in</span>
<span class="sd">            floating sub-requests per second. -1 means set no throttle.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">perform_request</span><span class="p">(</span>
            <span class="s2">&quot;POST&quot;</span><span class="p">,</span> <span class="n">_make_path</span><span class="p">(</span><span class="s2">&quot;_reindex&quot;</span><span class="p">,</span> <span class="n">task_id</span><span class="p">,</span> <span class="s2">&quot;_rethrottle&quot;</span><span class="p">),</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Elasticsearch.delete_by_query"><a class="viewcode-back" href="../../onegov_testing.html#onegov_testing.fixtures.Elasticsearch.delete_by_query">[docs]</a>    <span class="nd">@query_params</span><span class="p">(</span>
        <span class="s2">&quot;_source&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_source_exclude&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_source_excludes&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_source_include&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_source_includes&quot;</span><span class="p">,</span>
        <span class="s2">&quot;allow_no_indices&quot;</span><span class="p">,</span>
        <span class="s2">&quot;analyze_wildcard&quot;</span><span class="p">,</span>
        <span class="s2">&quot;analyzer&quot;</span><span class="p">,</span>
        <span class="s2">&quot;conflicts&quot;</span><span class="p">,</span>
        <span class="s2">&quot;default_operator&quot;</span><span class="p">,</span>
        <span class="s2">&quot;df&quot;</span><span class="p">,</span>
        <span class="s2">&quot;expand_wildcards&quot;</span><span class="p">,</span>
        <span class="s2">&quot;from_&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ignore_unavailable&quot;</span><span class="p">,</span>
        <span class="s2">&quot;lenient&quot;</span><span class="p">,</span>
        <span class="s2">&quot;preference&quot;</span><span class="p">,</span>
        <span class="s2">&quot;q&quot;</span><span class="p">,</span>
        <span class="s2">&quot;refresh&quot;</span><span class="p">,</span>
        <span class="s2">&quot;request_cache&quot;</span><span class="p">,</span>
        <span class="s2">&quot;requests_per_second&quot;</span><span class="p">,</span>
        <span class="s2">&quot;routing&quot;</span><span class="p">,</span>
        <span class="s2">&quot;scroll&quot;</span><span class="p">,</span>
        <span class="s2">&quot;scroll_size&quot;</span><span class="p">,</span>
        <span class="s2">&quot;search_timeout&quot;</span><span class="p">,</span>
        <span class="s2">&quot;search_type&quot;</span><span class="p">,</span>
        <span class="s2">&quot;size&quot;</span><span class="p">,</span>
        <span class="s2">&quot;slices&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sort&quot;</span><span class="p">,</span>
        <span class="s2">&quot;stats&quot;</span><span class="p">,</span>
        <span class="s2">&quot;terminate_after&quot;</span><span class="p">,</span>
        <span class="s2">&quot;timeout&quot;</span><span class="p">,</span>
        <span class="s2">&quot;version&quot;</span><span class="p">,</span>
        <span class="s2">&quot;wait_for_active_shards&quot;</span><span class="p">,</span>
        <span class="s2">&quot;wait_for_completion&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="nf">delete_by_query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">doc_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Delete all documents matching a query.</span>
<span class="sd">        `&lt;https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-delete-by-query.html&gt;`_</span>

<span class="sd">        :arg index: A comma-separated list of index names to search; use `_all`</span>
<span class="sd">            or empty string to perform the operation on all indices</span>
<span class="sd">        :arg body: The search definition using the Query DSL</span>
<span class="sd">        :arg doc_type: A comma-separated list of document types to search; leave</span>
<span class="sd">            empty to perform the operation on all types</span>
<span class="sd">        :arg _source: True or false to return the _source field or not, or a</span>
<span class="sd">            list of fields to return</span>
<span class="sd">        :arg _source_exclude: A list of fields to exclude from the returned</span>
<span class="sd">            _source field</span>
<span class="sd">        :arg _source_include: A list of fields to extract and return from the</span>
<span class="sd">            _source field</span>
<span class="sd">        :arg _source_excludes: A list of fields to exclude from the returned</span>
<span class="sd">            _source field</span>
<span class="sd">        :arg _source_includes: A list of fields to extract and return from the</span>
<span class="sd">            _source field</span>
<span class="sd">        :arg allow_no_indices: Whether to ignore if a wildcard indices</span>
<span class="sd">            expression resolves into no concrete indices. (This includes `_all`</span>
<span class="sd">            string or when no indices have been specified)</span>
<span class="sd">        :arg analyze_wildcard: Specify whether wildcard and prefix queries</span>
<span class="sd">            should be analyzed (default: false)</span>
<span class="sd">        :arg analyzer: The analyzer to use for the query string</span>
<span class="sd">        :arg conflicts: What to do when the delete-by-query hits version</span>
<span class="sd">            conflicts?, default &#39;abort&#39;, valid choices are: &#39;abort&#39;, &#39;proceed&#39;</span>
<span class="sd">        :arg default_operator: The default operator for query string query (AND</span>
<span class="sd">            or OR), default &#39;OR&#39;, valid choices are: &#39;AND&#39;, &#39;OR&#39;</span>
<span class="sd">        :arg df: The field to use as default where no field prefix is given in</span>
<span class="sd">            the query string</span>
<span class="sd">        :arg expand_wildcards: Whether to expand wildcard expression to concrete</span>
<span class="sd">            indices that are open, closed or both., default &#39;open&#39;, valid</span>
<span class="sd">            choices are: &#39;open&#39;, &#39;closed&#39;, &#39;none&#39;, &#39;all&#39;</span>
<span class="sd">        :arg from\\_: Starting offset (default: 0)</span>
<span class="sd">        :arg ignore_unavailable: Whether specified concrete indices should be</span>
<span class="sd">            ignored when unavailable (missing or closed)</span>
<span class="sd">        :arg lenient: Specify whether format-based query failures (such as</span>
<span class="sd">            providing text to a numeric field) should be ignored</span>
<span class="sd">        :arg preference: Specify the node or shard the operation should be</span>
<span class="sd">            performed on (default: random)</span>
<span class="sd">        :arg q: Query in the Lucene query string syntax</span>
<span class="sd">        :arg refresh: Should the effected indexes be refreshed?</span>
<span class="sd">        :arg request_cache: Specify if request cache should be used for this</span>
<span class="sd">            request or not, defaults to index level setting</span>
<span class="sd">        :arg requests_per_second: The throttle for this request in sub-requests</span>
<span class="sd">            per second. -1 means no throttle., default 0</span>
<span class="sd">        :arg routing: A comma-separated list of specific routing values</span>
<span class="sd">        :arg scroll: Specify how long a consistent view of the index should be</span>
<span class="sd">            maintained for scrolled search</span>
<span class="sd">        :arg scroll_size: Size on the scroll request powering the</span>
<span class="sd">            update_by_query</span>
<span class="sd">        :arg search_timeout: Explicit timeout for each search request. Defaults</span>
<span class="sd">            to no timeout.</span>
<span class="sd">        :arg search_type: Search operation type, valid choices are:</span>
<span class="sd">            &#39;query_then_fetch&#39;, &#39;dfs_query_then_fetch&#39;</span>
<span class="sd">        :arg size: Number of hits to return (default: 10)</span>
<span class="sd">        :arg slices: The number of slices this task should be divided into.</span>
<span class="sd">            Defaults to 1 meaning the task isn&#39;t sliced into subtasks., default</span>
<span class="sd">            1</span>
<span class="sd">        :arg sort: A comma-separated list of &lt;field&gt;:&lt;direction&gt; pairs</span>
<span class="sd">        :arg stats: Specific &#39;tag&#39; of the request for logging and statistical</span>
<span class="sd">            purposes</span>
<span class="sd">        :arg terminate_after: The maximum number of documents to collect for</span>
<span class="sd">            each shard, upon reaching which the query execution will terminate</span>
<span class="sd">            early.</span>
<span class="sd">        :arg timeout: Time each individual bulk request should wait for shards</span>
<span class="sd">            that are unavailable., default &#39;1m&#39;</span>
<span class="sd">        :arg version: Specify whether to return document version as part of a</span>
<span class="sd">            hit</span>
<span class="sd">        :arg wait_for_active_shards: Sets the number of shard copies that must</span>
<span class="sd">            be active before proceeding with the delete by query operation.</span>
<span class="sd">            Defaults to 1, meaning the primary shard only. Set to `all` for all</span>
<span class="sd">            shard copies, otherwise set to any non-negative value less than or</span>
<span class="sd">            equal to the total number of copies for the shard (number of</span>
<span class="sd">            replicas + 1)</span>
<span class="sd">        :arg wait_for_completion: Should the request should block until the</span>
<span class="sd">            delete-by-query is complete., default True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">body</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">SKIP_IN_PATH</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Empty value passed for a required argument.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">perform_request</span><span class="p">(</span>
            <span class="s2">&quot;POST&quot;</span><span class="p">,</span>
            <span class="n">_make_path</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">doc_type</span><span class="p">,</span> <span class="s2">&quot;_delete_by_query&quot;</span><span class="p">),</span>
            <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
            <span class="n">body</span><span class="o">=</span><span class="n">body</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Elasticsearch.delete_by_query_rethrottle"><a class="viewcode-back" href="../../onegov_testing.html#onegov_testing.fixtures.Elasticsearch.delete_by_query_rethrottle">[docs]</a>    <span class="nd">@query_params</span><span class="p">(</span><span class="s2">&quot;requests_per_second&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">delete_by_query_rethrottle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_id</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        `&lt;https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-delete-by-query.html&gt;`_</span>

<span class="sd">        :arg task_id: The task id to rethrottle</span>
<span class="sd">        :arg requests_per_second: The throttle to set on this request in</span>
<span class="sd">            floating sub-requests per second. -1 means set no throttle.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">task_id</span> <span class="ow">in</span> <span class="n">SKIP_IN_PATH</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Empty value passed for a required argument &#39;task_id&#39;.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">perform_request</span><span class="p">(</span>
            <span class="s2">&quot;POST&quot;</span><span class="p">,</span>
            <span class="n">_make_path</span><span class="p">(</span><span class="s2">&quot;_delete_by_query&quot;</span><span class="p">,</span> <span class="n">task_id</span><span class="p">,</span> <span class="s2">&quot;_rethrottle&quot;</span><span class="p">),</span>
            <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Elasticsearch.search_shards"><a class="viewcode-back" href="../../onegov_testing.html#onegov_testing.fixtures.Elasticsearch.search_shards">[docs]</a>    <span class="nd">@query_params</span><span class="p">(</span>
        <span class="s2">&quot;allow_no_indices&quot;</span><span class="p">,</span>
        <span class="s2">&quot;expand_wildcards&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ignore_unavailable&quot;</span><span class="p">,</span>
        <span class="s2">&quot;local&quot;</span><span class="p">,</span>
        <span class="s2">&quot;preference&quot;</span><span class="p">,</span>
        <span class="s2">&quot;routing&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="nf">search_shards</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">doc_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The search shards api returns the indices and shards that a search</span>
<span class="sd">        request would be executed against. This can give useful feedback for working</span>
<span class="sd">        out issues or planning optimizations with routing and shard preferences.</span>
<span class="sd">        `&lt;http://www.elastic.co/guide/en/elasticsearch/reference/current/search-shards.html&gt;`_</span>

<span class="sd">        :arg index: A comma-separated list of index names to search; use `_all`</span>
<span class="sd">            or empty string to perform the operation on all indices</span>
<span class="sd">        :arg allow_no_indices: Whether to ignore if a wildcard indices</span>
<span class="sd">            expression resolves into no concrete indices. (This includes `_all`</span>
<span class="sd">            string or when no indices have been specified)</span>
<span class="sd">        :arg expand_wildcards: Whether to expand wildcard expression to concrete</span>
<span class="sd">            indices that are open, closed or both., default &#39;open&#39;, valid</span>
<span class="sd">            choices are: &#39;open&#39;, &#39;closed&#39;, &#39;none&#39;, &#39;all&#39;</span>
<span class="sd">        :arg ignore_unavailable: Whether specified concrete indices should be</span>
<span class="sd">            ignored when unavailable (missing or closed)</span>
<span class="sd">        :arg local: Return local information, do not retrieve the state from</span>
<span class="sd">            master node (default: false)</span>
<span class="sd">        :arg preference: Specify the node or shard the operation should be</span>
<span class="sd">            performed on (default: random)</span>
<span class="sd">        :arg routing: Specific routing value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">perform_request</span><span class="p">(</span>
            <span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">_make_path</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">doc_type</span><span class="p">,</span> <span class="s2">&quot;_search_shards&quot;</span><span class="p">),</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Elasticsearch.search_template"><a class="viewcode-back" href="../../onegov_testing.html#onegov_testing.fixtures.Elasticsearch.search_template">[docs]</a>    <span class="nd">@query_params</span><span class="p">(</span>
        <span class="s2">&quot;allow_no_indices&quot;</span><span class="p">,</span>
        <span class="s2">&quot;expand_wildcards&quot;</span><span class="p">,</span>
        <span class="s2">&quot;explain&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ignore_throttled&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ignore_unavailable&quot;</span><span class="p">,</span>
        <span class="s2">&quot;preference&quot;</span><span class="p">,</span>
        <span class="s2">&quot;profile&quot;</span><span class="p">,</span>
        <span class="s2">&quot;routing&quot;</span><span class="p">,</span>
        <span class="s2">&quot;scroll&quot;</span><span class="p">,</span>
        <span class="s2">&quot;search_type&quot;</span><span class="p">,</span>
        <span class="s2">&quot;typed_keys&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="nf">search_template</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">doc_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A query that accepts a query template and a map of key/value pairs to</span>
<span class="sd">        fill in template parameters.</span>
<span class="sd">        `&lt;http://www.elastic.co/guide/en/elasticsearch/reference/current/search-template.html&gt;`_</span>

<span class="sd">        :arg index: A comma-separated list of index names to search; use `_all`</span>
<span class="sd">            or empty string to perform the operation on all indices</span>
<span class="sd">        :arg doc_type: A comma-separated list of document types to search; leave</span>
<span class="sd">            empty to perform the operation on all types</span>
<span class="sd">        :arg body: The search definition template and its params</span>
<span class="sd">        :arg allow_no_indices: Whether to ignore if a wildcard indices</span>
<span class="sd">            expression resolves into no concrete indices. (This includes `_all`</span>
<span class="sd">            string or when no indices have been specified)</span>
<span class="sd">        :arg expand_wildcards: Whether to expand wildcard expression to concrete</span>
<span class="sd">            indices that are open, closed or both., default &#39;open&#39;, valid</span>
<span class="sd">            choices are: &#39;open&#39;, &#39;closed&#39;, &#39;none&#39;, &#39;all&#39;</span>
<span class="sd">        :arg explain: Specify whether to return detailed information about score</span>
<span class="sd">            computation as part of a hit</span>
<span class="sd">        :arg ignore_throttled: Whether specified concrete, expanded or aliased</span>
<span class="sd">            indices should be ignored when throttled</span>
<span class="sd">        :arg ignore_unavailable: Whether specified concrete indices should be</span>
<span class="sd">            ignored when unavailable (missing or closed)</span>
<span class="sd">        :arg preference: Specify the node or shard the operation should be</span>
<span class="sd">            performed on (default: random)</span>
<span class="sd">        :arg profile: Specify whether to profile the query execution</span>
<span class="sd">        :arg routing: A comma-separated list of specific routing values</span>
<span class="sd">        :arg scroll: Specify how long a consistent view of the index should be</span>
<span class="sd">            maintained for scrolled search</span>
<span class="sd">        :arg search_type: Search operation type, valid choices are:</span>
<span class="sd">            &#39;query_then_fetch&#39;, &#39;query_and_fetch&#39;, &#39;dfs_query_then_fetch&#39;,</span>
<span class="sd">            &#39;dfs_query_and_fetch&#39;</span>
<span class="sd">        :arg typed_keys: Specify whether aggregation and suggester names should</span>
<span class="sd">            be prefixed by their respective types in the response</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">perform_request</span><span class="p">(</span>
            <span class="s2">&quot;GET&quot;</span><span class="p">,</span>
            <span class="n">_make_path</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">doc_type</span><span class="p">,</span> <span class="s2">&quot;_search&quot;</span><span class="p">,</span> <span class="s2">&quot;template&quot;</span><span class="p">),</span>
            <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
            <span class="n">body</span><span class="o">=</span><span class="n">body</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Elasticsearch.explain"><a class="viewcode-back" href="../../onegov_testing.html#onegov_testing.fixtures.Elasticsearch.explain">[docs]</a>    <span class="nd">@query_params</span><span class="p">(</span>
        <span class="s2">&quot;_source&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_source_exclude&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_source_include&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_source_excludes&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_source_includes&quot;</span><span class="p">,</span>
        <span class="s2">&quot;analyze_wildcard&quot;</span><span class="p">,</span>
        <span class="s2">&quot;analyzer&quot;</span><span class="p">,</span>
        <span class="s2">&quot;default_operator&quot;</span><span class="p">,</span>
        <span class="s2">&quot;df&quot;</span><span class="p">,</span>
        <span class="s2">&quot;lenient&quot;</span><span class="p">,</span>
        <span class="s2">&quot;parent&quot;</span><span class="p">,</span>
        <span class="s2">&quot;preference&quot;</span><span class="p">,</span>
        <span class="s2">&quot;q&quot;</span><span class="p">,</span>
        <span class="s2">&quot;routing&quot;</span><span class="p">,</span>
        <span class="s2">&quot;stored_fields&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="nf">explain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">doc_type</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The explain api computes a score explanation for a query and a specific</span>
<span class="sd">        document. This can give useful feedback whether a document matches or</span>
<span class="sd">        didn&#39;t match a specific query.</span>
<span class="sd">        `&lt;http://www.elastic.co/guide/en/elasticsearch/reference/current/search-explain.html&gt;`_</span>

<span class="sd">        :arg index: The name of the index</span>
<span class="sd">        :arg doc_type: The type of the document</span>
<span class="sd">        :arg id: The document ID</span>
<span class="sd">        :arg body: The query definition using the Query DSL</span>
<span class="sd">        :arg _source: True or false to return the _source field or not, or a</span>
<span class="sd">            list of fields to return</span>
<span class="sd">        :arg _source_exclude: A list of fields to exclude from the returned</span>
<span class="sd">            _source field</span>
<span class="sd">        :arg _source_include: A list of fields to extract and return from the</span>
<span class="sd">            _source field</span>
<span class="sd">        :arg _source_excludes: A list of fields to exclude from the returned</span>
<span class="sd">            _source field</span>
<span class="sd">        :arg _source_includes: A list of fields to extract and return from the</span>
<span class="sd">            _source field</span>
<span class="sd">        :arg analyze_wildcard: Specify whether wildcards and prefix queries in</span>
<span class="sd">            the query string query should be analyzed (default: false)</span>
<span class="sd">        :arg analyzer: The analyzer for the query string query</span>
<span class="sd">        :arg default_operator: The default operator for query string query (AND</span>
<span class="sd">            or OR), default &#39;OR&#39;, valid choices are: &#39;AND&#39;, &#39;OR&#39;</span>
<span class="sd">        :arg df: The default field for query string query (default: _all)</span>
<span class="sd">        :arg lenient: Specify whether format-based query failures (such as</span>
<span class="sd">            providing text to a numeric field) should be ignored</span>
<span class="sd">        :arg parent: The ID of the parent document</span>
<span class="sd">        :arg preference: Specify the node or shard the operation should be</span>
<span class="sd">            performed on (default: random)</span>
<span class="sd">        :arg q: Query in the Lucene query string syntax</span>
<span class="sd">        :arg routing: Specific routing value</span>
<span class="sd">        :arg stored_fields: A comma-separated list of stored fields to return in</span>
<span class="sd">            the response</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">doc_type</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">SKIP_IN_PATH</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Empty value passed for a required argument.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">perform_request</span><span class="p">(</span>
            <span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">_make_path</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">doc_type</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="s2">&quot;_explain&quot;</span><span class="p">),</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">body</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Elasticsearch.scroll"><a class="viewcode-back" href="../../onegov_testing.html#onegov_testing.fixtures.Elasticsearch.scroll">[docs]</a>    <span class="nd">@query_params</span><span class="p">(</span><span class="s2">&quot;rest_total_hits_as_int&quot;</span><span class="p">,</span> <span class="s2">&quot;scroll&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">scroll</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scroll_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        `&lt;http://www.elastic.co/guide/en/elasticsearch/reference/master/search-request-scroll.html&gt;`_</span>

<span class="sd">        :arg scroll_id: The scroll ID</span>
<span class="sd">        :arg body: The scroll ID if not passed by URL or query parameter.</span>
<span class="sd">        :arg rest_total_hits_as_int: This parameter is ignored in this version.</span>
<span class="sd">            It is used in the next major version to control whether the rest</span>
<span class="sd">            response should render the total.hits as an object or a number,</span>
<span class="sd">            default False</span>
<span class="sd">        :arg scroll: Specify how long a consistent view of the index should be</span>
<span class="sd">            maintained for scrolled search</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">perform_request</span><span class="p">(</span>
            <span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">_make_path</span><span class="p">(</span><span class="s2">&quot;_search&quot;</span><span class="p">,</span> <span class="s2">&quot;scroll&quot;</span><span class="p">,</span> <span class="n">scroll_id</span><span class="p">),</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">body</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Elasticsearch.clear_scroll"><a class="viewcode-back" href="../../onegov_testing.html#onegov_testing.fixtures.Elasticsearch.clear_scroll">[docs]</a>    <span class="nd">@query_params</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">clear_scroll</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scroll_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Clear the scroll request created by specifying the scroll parameter to</span>
<span class="sd">        search.</span>
<span class="sd">        `&lt;http://www.elastic.co/guide/en/elasticsearch/reference/current/search-request-scroll.html&gt;`_</span>

<span class="sd">        :arg scroll_id: A comma-separated list of scroll IDs to clear</span>
<span class="sd">        :arg body: A comma-separated list of scroll IDs to clear if none was</span>
<span class="sd">            specified via the scroll_id parameter</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">scroll_id</span> <span class="ow">in</span> <span class="n">SKIP_IN_PATH</span> <span class="ow">and</span> <span class="n">body</span> <span class="ow">in</span> <span class="n">SKIP_IN_PATH</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;You need to supply scroll_id or body.&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">scroll_id</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">body</span><span class="p">:</span>
            <span class="n">body</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;scroll_id&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">scroll_id</span><span class="p">]}</span>
        <span class="k">elif</span> <span class="n">scroll_id</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;scroll_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scroll_id</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">perform_request</span><span class="p">(</span>
            <span class="s2">&quot;DELETE&quot;</span><span class="p">,</span> <span class="s2">&quot;/_search/scroll&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">body</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Elasticsearch.delete"><a class="viewcode-back" href="../../onegov_testing.html#onegov_testing.fixtures.Elasticsearch.delete">[docs]</a>    <span class="nd">@query_params</span><span class="p">(</span>
        <span class="s2">&quot;if_primary_term&quot;</span><span class="p">,</span>
        <span class="s2">&quot;if_seq_no&quot;</span><span class="p">,</span>
        <span class="s2">&quot;parent&quot;</span><span class="p">,</span>
        <span class="s2">&quot;refresh&quot;</span><span class="p">,</span>
        <span class="s2">&quot;routing&quot;</span><span class="p">,</span>
        <span class="s2">&quot;timeout&quot;</span><span class="p">,</span>
        <span class="s2">&quot;version&quot;</span><span class="p">,</span>
        <span class="s2">&quot;version_type&quot;</span><span class="p">,</span>
        <span class="s2">&quot;wait_for_active_shards&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">doc_type</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Delete a typed JSON document from a specific index based on its id.</span>
<span class="sd">        `&lt;http://www.elastic.co/guide/en/elasticsearch/reference/current/docs-delete.html&gt;`_</span>

<span class="sd">        :arg index: The name of the index</span>
<span class="sd">        :arg doc_type: The type of the document</span>
<span class="sd">        :arg id: The document ID</span>
<span class="sd">        :arg if_primary_term: only perform the delete operation if the last</span>
<span class="sd">            operation that has changed the document has the specified primary</span>
<span class="sd">            term</span>
<span class="sd">        :arg if_seq_no: only perform the delete operation if the last operation</span>
<span class="sd">        :arg parent: ID of parent document</span>
<span class="sd">        :arg refresh: If `true` then refresh the effected shards to make this</span>
<span class="sd">            operation visible to search, if `wait_for` then wait for a refresh</span>
<span class="sd">            to make this operation visible to search, if `false` (the default)</span>
<span class="sd">            then do nothing with refreshes., valid choices are: &#39;true&#39;, &#39;false&#39;,</span>
<span class="sd">            &#39;wait_for&#39;</span>
<span class="sd">        :arg routing: Specific routing value</span>
<span class="sd">        :arg timeout: Explicit operation timeout</span>
<span class="sd">        :arg version: Explicit version number for concurrency control</span>
<span class="sd">        :arg version_type: Specific version type, valid choices are: &#39;internal&#39;,</span>
<span class="sd">            &#39;external&#39;, &#39;external_gte&#39;, &#39;force&#39;</span>
<span class="sd">        :arg wait_for_active_shards: Sets the number of shard copies that must</span>
<span class="sd">            be active before proceeding with the delete operation. Defaults to</span>
<span class="sd">            1, meaning the primary shard only. Set to `all` for all shard</span>
<span class="sd">            copies, otherwise set to any non-negative value less than or equal</span>
<span class="sd">            to the total number of copies for the shard (number of replicas + 1)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">doc_type</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">SKIP_IN_PATH</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Empty value passed for a required argument.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">perform_request</span><span class="p">(</span>
            <span class="s2">&quot;DELETE&quot;</span><span class="p">,</span> <span class="n">_make_path</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">doc_type</span><span class="p">,</span> <span class="nb">id</span><span class="p">),</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Elasticsearch.count"><a class="viewcode-back" href="../../onegov_testing.html#onegov_testing.fixtures.Elasticsearch.count">[docs]</a>    <span class="nd">@query_params</span><span class="p">(</span>
        <span class="s2">&quot;allow_no_indices&quot;</span><span class="p">,</span>
        <span class="s2">&quot;analyze_wildcard&quot;</span><span class="p">,</span>
        <span class="s2">&quot;analyzer&quot;</span><span class="p">,</span>
        <span class="s2">&quot;default_operator&quot;</span><span class="p">,</span>
        <span class="s2">&quot;df&quot;</span><span class="p">,</span>
        <span class="s2">&quot;expand_wildcards&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ignore_unavailable&quot;</span><span class="p">,</span>
        <span class="s2">&quot;lenient&quot;</span><span class="p">,</span>
        <span class="s2">&quot;min_score&quot;</span><span class="p">,</span>
        <span class="s2">&quot;preference&quot;</span><span class="p">,</span>
        <span class="s2">&quot;q&quot;</span><span class="p">,</span>
        <span class="s2">&quot;routing&quot;</span><span class="p">,</span>
        <span class="s2">&quot;terminate_after&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="nf">count</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">doc_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Execute a query and get the number of matches for that query.</span>
<span class="sd">        `&lt;http://www.elastic.co/guide/en/elasticsearch/reference/current/search-count.html&gt;`_</span>

<span class="sd">        :arg index: A comma-separated list of indices to restrict the results</span>
<span class="sd">        :arg doc_type: A comma-separated list of types to restrict the results</span>
<span class="sd">        :arg body: A query to restrict the results specified with the Query DSL</span>
<span class="sd">            (optional)</span>
<span class="sd">        :arg allow_no_indices: Whether to ignore if a wildcard indices</span>
<span class="sd">            expression resolves into no concrete indices. (This includes `_all`</span>
<span class="sd">            string or when no indices have been specified)</span>
<span class="sd">        :arg analyze_wildcard: Specify whether wildcard and prefix queries</span>
<span class="sd">            should be analyzed (default: false)</span>
<span class="sd">        :arg analyzer: The analyzer to use for the query string</span>
<span class="sd">        :arg default_operator: The default operator for query string query (AND</span>
<span class="sd">            or OR), default &#39;OR&#39;, valid choices are: &#39;AND&#39;, &#39;OR&#39;</span>
<span class="sd">        :arg df: The field to use as default where no field prefix is given in</span>
<span class="sd">            the query string</span>
<span class="sd">        :arg expand_wildcards: Whether to expand wildcard expression to concrete</span>
<span class="sd">            indices that are open, closed or both., default &#39;open&#39;, valid</span>
<span class="sd">            choices are: &#39;open&#39;, &#39;closed&#39;, &#39;none&#39;, &#39;all&#39;</span>
<span class="sd">        :arg ignore_unavailable: Whether specified concrete indices should be</span>
<span class="sd">            ignored when unavailable (missing or closed)</span>
<span class="sd">        :arg lenient: Specify whether format-based query failures (such as</span>
<span class="sd">            providing text to a numeric field) should be ignored</span>
<span class="sd">        :arg min_score: Include only documents with a specific `_score` value in</span>
<span class="sd">            the result</span>
<span class="sd">        :arg preference: Specify the node or shard the operation should be</span>
<span class="sd">            performed on (default: random)</span>
<span class="sd">        :arg q: Query in the Lucene query string syntax</span>
<span class="sd">        :arg routing: Specific routing value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">doc_type</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">index</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="s2">&quot;_all&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">perform_request</span><span class="p">(</span>
            <span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">_make_path</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">doc_type</span><span class="p">,</span> <span class="s2">&quot;_count&quot;</span><span class="p">),</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">body</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Elasticsearch.bulk"><a class="viewcode-back" href="../../onegov_testing.html#onegov_testing.fixtures.Elasticsearch.bulk">[docs]</a>    <span class="nd">@query_params</span><span class="p">(</span>
        <span class="s2">&quot;_source&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_source_exclude&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_source_excludes&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_source_include&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_source_includes&quot;</span><span class="p">,</span>
        <span class="s2">&quot;fields&quot;</span><span class="p">,</span>
        <span class="s2">&quot;pipeline&quot;</span><span class="p">,</span>
        <span class="s2">&quot;refresh&quot;</span><span class="p">,</span>
        <span class="s2">&quot;routing&quot;</span><span class="p">,</span>
        <span class="s2">&quot;timeout&quot;</span><span class="p">,</span>
        <span class="s2">&quot;wait_for_active_shards&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="nf">bulk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">doc_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Perform many index/delete operations in a single API call.</span>

<span class="sd">        See the :func:`~elasticsearch.helpers.bulk` helper function for a more</span>
<span class="sd">        friendly API.</span>
<span class="sd">        `&lt;http://www.elastic.co/guide/en/elasticsearch/reference/current/docs-bulk.html&gt;`_</span>

<span class="sd">        :arg body: The operation definition and data (action-data pairs),</span>
<span class="sd">            separated by newlines</span>
<span class="sd">        :arg index: Default index for items which don&#39;t provide one</span>
<span class="sd">        :arg doc_type: Default document type for items which don&#39;t provide one</span>
<span class="sd">        :arg _source: True or false to return the _source field or not, or</span>
<span class="sd">            default list of fields to return, can be overridden on each sub-</span>
<span class="sd">            request</span>
<span class="sd">        :arg _source_exclude: Default list of fields to exclude from the</span>
<span class="sd">            returned _source field, can be overridden on each sub-request</span>
<span class="sd">        :arg _source_include: Default list of fields to extract and return from</span>
<span class="sd">            the _source field, can be overridden on each sub-request</span>
<span class="sd">        :arg _source_exclude: Default list of fields to exclude from the</span>
<span class="sd">            returned _source field, can be overridden on each sub-request</span>
<span class="sd">        :arg _source_include: Default list of fields to extract and return from</span>
<span class="sd">            the _source field, can be overridden on each sub-request</span>
<span class="sd">        :arg fields: Default comma-separated list of fields to return in the</span>
<span class="sd">            response for updates, can be overridden on each sub-request</span>
<span class="sd">        :arg pipeline: The pipeline id to preprocess incoming documents with</span>
<span class="sd">        :arg refresh: If `true` then refresh the effected shards to make this</span>
<span class="sd">            operation visible to search, if `wait_for` then wait for a refresh</span>
<span class="sd">            to make this operation visible to search, if `false` (the default)</span>
<span class="sd">            then do nothing with refreshes., valid choices are: &#39;true&#39;, &#39;false&#39;,</span>
<span class="sd">            &#39;wait_for&#39;</span>
<span class="sd">        :arg routing: Specific routing value</span>
<span class="sd">        :arg timeout: Explicit operation timeout</span>
<span class="sd">        :arg wait_for_active_shards: Sets the number of shard copies that must</span>
<span class="sd">            be active before proceeding with the bulk operation. Defaults to 1,</span>
<span class="sd">            meaning the primary shard only. Set to `all` for all shard copies,</span>
<span class="sd">            otherwise set to any non-negative value less than or equal to the</span>
<span class="sd">            total number of copies for the shard (number of replicas + 1)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">body</span> <span class="ow">in</span> <span class="n">SKIP_IN_PATH</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Empty value passed for a required argument &#39;body&#39;.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">perform_request</span><span class="p">(</span>
            <span class="s2">&quot;POST&quot;</span><span class="p">,</span>
            <span class="n">_make_path</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">doc_type</span><span class="p">,</span> <span class="s2">&quot;_bulk&quot;</span><span class="p">),</span>
            <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
            <span class="n">body</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_bulk_body</span><span class="p">(</span><span class="n">body</span><span class="p">),</span>
            <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;content-type&quot;</span><span class="p">:</span> <span class="s2">&quot;application/x-ndjson&quot;</span><span class="p">},</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Elasticsearch.msearch"><a class="viewcode-back" href="../../onegov_testing.html#onegov_testing.fixtures.Elasticsearch.msearch">[docs]</a>    <span class="nd">@query_params</span><span class="p">(</span>
        <span class="s2">&quot;max_concurrent_searches&quot;</span><span class="p">,</span>
        <span class="s2">&quot;max_concurrent_shard_requests&quot;</span><span class="p">,</span>
        <span class="s2">&quot;pre_filter_shard_size&quot;</span><span class="p">,</span>
        <span class="s2">&quot;rest_total_hits_as_int&quot;</span><span class="p">,</span>
        <span class="s2">&quot;search_type&quot;</span><span class="p">,</span>
        <span class="s2">&quot;typed_keys&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="nf">msearch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">doc_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Execute several search requests within the same API.</span>
<span class="sd">        `&lt;http://www.elastic.co/guide/en/elasticsearch/reference/current/search-multi-search.html&gt;`_</span>

<span class="sd">        :arg body: The request definitions (metadata-search request definition</span>
<span class="sd">            pairs), separated by newlines</span>
<span class="sd">        :arg index: A comma-separated list of index names to use as default</span>
<span class="sd">        :arg doc_type: A comma-separated list of document types to use as</span>
<span class="sd">            default</span>
<span class="sd">        :arg max_concurrent_searches: Controls the maximum number of concurrent</span>
<span class="sd">            searches the multi search api will execute</span>
<span class="sd">        :arg max_concurrent_shard_requests: The number of concurrent shard</span>
<span class="sd">            requests each sub search executes concurrently. This value should be</span>
<span class="sd">            used to limit the impact of the search on the cluster in order to</span>
<span class="sd">            limit the number of concurrent shard requests, default &#39;The default</span>
<span class="sd">            grows with the number of nodes in the cluster but is at most 256.&#39;</span>
<span class="sd">        :arg pre_filter_shard_size: A threshold that enforces a pre-filter</span>
<span class="sd">            roundtrip to prefilter search shards based on query rewriting if</span>
<span class="sd">            the number of shards the search request expands to exceeds the</span>
<span class="sd">            threshold. This filter roundtrip can limit the number of shards</span>
<span class="sd">            significantly if for instance a shard can not match any documents</span>
<span class="sd">            based on it&#39;s rewrite method ie. if date filters are mandatory to</span>
<span class="sd">            match but the shard bounds and the query are disjoint., default 128</span>
<span class="sd">        :arg rest_total_hits_as_int: This parameter is ignored in this version.</span>
<span class="sd">            It is used in the next major version to control whether the rest</span>
<span class="sd">            response should render the total.hits as an object or a number,</span>
<span class="sd">            default False</span>
<span class="sd">        :arg search_type: Search operation type, valid choices are:</span>
<span class="sd">            &#39;query_then_fetch&#39;, &#39;query_and_fetch&#39;, &#39;dfs_query_then_fetch&#39;,</span>
<span class="sd">            &#39;dfs_query_and_fetch&#39;</span>
<span class="sd">        :arg typed_keys: Specify whether aggregation and suggester names should</span>
<span class="sd">            be prefixed by their respective types in the response</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">body</span> <span class="ow">in</span> <span class="n">SKIP_IN_PATH</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Empty value passed for a required argument &#39;body&#39;.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">perform_request</span><span class="p">(</span>
            <span class="s2">&quot;GET&quot;</span><span class="p">,</span>
            <span class="n">_make_path</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">doc_type</span><span class="p">,</span> <span class="s2">&quot;_msearch&quot;</span><span class="p">),</span>
            <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
            <span class="n">body</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_bulk_body</span><span class="p">(</span><span class="n">body</span><span class="p">),</span>
            <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;content-type&quot;</span><span class="p">:</span> <span class="s2">&quot;application/x-ndjson&quot;</span><span class="p">},</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Elasticsearch.termvectors"><a class="viewcode-back" href="../../onegov_testing.html#onegov_testing.fixtures.Elasticsearch.termvectors">[docs]</a>    <span class="nd">@query_params</span><span class="p">(</span>
        <span class="s2">&quot;field_statistics&quot;</span><span class="p">,</span>
        <span class="s2">&quot;fields&quot;</span><span class="p">,</span>
        <span class="s2">&quot;offsets&quot;</span><span class="p">,</span>
        <span class="s2">&quot;parent&quot;</span><span class="p">,</span>
        <span class="s2">&quot;payloads&quot;</span><span class="p">,</span>
        <span class="s2">&quot;positions&quot;</span><span class="p">,</span>
        <span class="s2">&quot;preference&quot;</span><span class="p">,</span>
        <span class="s2">&quot;realtime&quot;</span><span class="p">,</span>
        <span class="s2">&quot;routing&quot;</span><span class="p">,</span>
        <span class="s2">&quot;term_statistics&quot;</span><span class="p">,</span>
        <span class="s2">&quot;version&quot;</span><span class="p">,</span>
        <span class="s2">&quot;version_type&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="nf">termvectors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">doc_type</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns information and statistics on terms in the fields of a</span>
<span class="sd">        particular document. The document could be stored in the index or</span>
<span class="sd">        artificially provided by the user (Added in 1.4). Note that for</span>
<span class="sd">        documents stored in the index, this is a near realtime API as the term</span>
<span class="sd">        vectors are not available until the next refresh.</span>
<span class="sd">        `&lt;http://www.elastic.co/guide/en/elasticsearch/reference/current/docs-termvectors.html&gt;`_</span>

<span class="sd">        :arg index: The index in which the document resides.</span>
<span class="sd">        :arg doc_type: The type of the document.</span>
<span class="sd">        :arg id: The id of the document, when not specified a doc param should</span>
<span class="sd">            be supplied.</span>
<span class="sd">        :arg body: Define parameters and or supply a document to get termvectors</span>
<span class="sd">            for. See documentation.</span>
<span class="sd">        :arg field_statistics: Specifies if document count, sum of document</span>
<span class="sd">            frequencies and sum of total term frequencies should be returned.,</span>
<span class="sd">            default True</span>
<span class="sd">        :arg fields: A comma-separated list of fields to return.</span>
<span class="sd">        :arg offsets: Specifies if term offsets should be returned., default</span>
<span class="sd">            True</span>
<span class="sd">        :arg parent: Parent id of documents.</span>
<span class="sd">        :arg payloads: Specifies if term payloads should be returned., default</span>
<span class="sd">            True</span>
<span class="sd">        :arg positions: Specifies if term positions should be returned., default</span>
<span class="sd">            True</span>
<span class="sd">        :arg preference: Specify the node or shard the operation should be</span>
<span class="sd">            performed on (default: random).</span>
<span class="sd">        :arg realtime: Specifies if request is real-time as opposed to near-</span>
<span class="sd">            real-time (default: true).</span>
<span class="sd">        :arg routing: Specific routing value.</span>
<span class="sd">        :arg term_statistics: Specifies if total term frequency and document</span>
<span class="sd">            frequency should be returned., default False</span>
<span class="sd">        :arg version: Explicit version number for concurrency control</span>
<span class="sd">        :arg version_type: Specific version type, valid choices are: &#39;internal&#39;,</span>
<span class="sd">            &#39;external&#39;, &#39;external_gte&#39;, &#39;force&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">doc_type</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">SKIP_IN_PATH</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Empty value passed for a required argument.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">perform_request</span><span class="p">(</span>
            <span class="s2">&quot;GET&quot;</span><span class="p">,</span>
            <span class="n">_make_path</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">doc_type</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="s2">&quot;_termvectors&quot;</span><span class="p">),</span>
            <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
            <span class="n">body</span><span class="o">=</span><span class="n">body</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Elasticsearch.mtermvectors"><a class="viewcode-back" href="../../onegov_testing.html#onegov_testing.fixtures.Elasticsearch.mtermvectors">[docs]</a>    <span class="nd">@query_params</span><span class="p">(</span>
        <span class="s2">&quot;field_statistics&quot;</span><span class="p">,</span>
        <span class="s2">&quot;fields&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ids&quot;</span><span class="p">,</span>
        <span class="s2">&quot;offsets&quot;</span><span class="p">,</span>
        <span class="s2">&quot;parent&quot;</span><span class="p">,</span>
        <span class="s2">&quot;payloads&quot;</span><span class="p">,</span>
        <span class="s2">&quot;positions&quot;</span><span class="p">,</span>
        <span class="s2">&quot;preference&quot;</span><span class="p">,</span>
        <span class="s2">&quot;realtime&quot;</span><span class="p">,</span>
        <span class="s2">&quot;routing&quot;</span><span class="p">,</span>
        <span class="s2">&quot;term_statistics&quot;</span><span class="p">,</span>
        <span class="s2">&quot;version&quot;</span><span class="p">,</span>
        <span class="s2">&quot;version_type&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="nf">mtermvectors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">doc_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Multi termvectors API allows to get multiple termvectors based on an</span>
<span class="sd">        index, type and id.</span>
<span class="sd">        `&lt;http://www.elastic.co/guide/en/elasticsearch/reference/current/docs-multi-termvectors.html&gt;`_</span>

<span class="sd">        :arg index: The index in which the document resides.</span>
<span class="sd">        :arg doc_type: The type of the document.</span>
<span class="sd">        :arg body: Define ids, documents, parameters or a list of parameters per</span>
<span class="sd">            document here. You must at least provide a list of document ids. See</span>
<span class="sd">            documentation.</span>
<span class="sd">        :arg field_statistics: Specifies if document count, sum of document</span>
<span class="sd">            frequencies and sum of total term frequencies should be returned.</span>
<span class="sd">            Applies to all returned documents unless otherwise specified in body</span>
<span class="sd">            &quot;params&quot; or &quot;docs&quot;., default True</span>
<span class="sd">        :arg fields: A comma-separated list of fields to return. Applies to all</span>
<span class="sd">            returned documents unless otherwise specified in body &quot;params&quot; or</span>
<span class="sd">            &quot;docs&quot;.</span>
<span class="sd">        :arg ids: A comma-separated list of documents ids. You must define ids</span>
<span class="sd">            as parameter or set &quot;ids&quot; or &quot;docs&quot; in the request body</span>
<span class="sd">        :arg offsets: Specifies if term offsets should be returned. Applies to</span>
<span class="sd">            all returned documents unless otherwise specified in body &quot;params&quot;</span>
<span class="sd">            or &quot;docs&quot;., default True</span>
<span class="sd">        :arg parent: Parent id of documents. Applies to all returned documents</span>
<span class="sd">            unless otherwise specified in body &quot;params&quot; or &quot;docs&quot;.</span>
<span class="sd">        :arg payloads: Specifies if term payloads should be returned. Applies to</span>
<span class="sd">            all returned documents unless otherwise specified in body &quot;params&quot;</span>
<span class="sd">            or &quot;docs&quot;., default True</span>
<span class="sd">        :arg positions: Specifies if term positions should be returned. Applies</span>
<span class="sd">            to all returned documents unless otherwise specified in body</span>
<span class="sd">            &quot;params&quot; or &quot;docs&quot;., default True</span>
<span class="sd">        :arg preference: Specify the node or shard the operation should be</span>
<span class="sd">            performed on (default: random) .Applies to all returned documents</span>
<span class="sd">            unless otherwise specified in body &quot;params&quot; or &quot;docs&quot;.</span>
<span class="sd">        :arg realtime: Specifies if requests are real-time as opposed to near-</span>
<span class="sd">            real-time (default: true).</span>
<span class="sd">        :arg routing: Specific routing value. Applies to all returned documents</span>
<span class="sd">            unless otherwise specified in body &quot;params&quot; or &quot;docs&quot;.</span>
<span class="sd">        :arg term_statistics: Specifies if total term frequency and document</span>
<span class="sd">            frequency should be returned. Applies to all returned documents</span>
<span class="sd">            unless otherwise specified in body &quot;params&quot; or &quot;docs&quot;., default</span>
<span class="sd">            False</span>
<span class="sd">        :arg version: Explicit version number for concurrency control</span>
<span class="sd">        :arg version_type: Specific version type, valid choices are: &#39;internal&#39;,</span>
<span class="sd">            &#39;external&#39;, &#39;external_gte&#39;, &#39;force&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">perform_request</span><span class="p">(</span>
            <span class="s2">&quot;GET&quot;</span><span class="p">,</span>
            <span class="n">_make_path</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">doc_type</span><span class="p">,</span> <span class="s2">&quot;_mtermvectors&quot;</span><span class="p">),</span>
            <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
            <span class="n">body</span><span class="o">=</span><span class="n">body</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Elasticsearch.put_script"><a class="viewcode-back" href="../../onegov_testing.html#onegov_testing.fixtures.Elasticsearch.put_script">[docs]</a>    <span class="nd">@query_params</span><span class="p">(</span><span class="s2">&quot;master_timeout&quot;</span><span class="p">,</span> <span class="s2">&quot;timeout&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">put_script</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        `&lt;http://www.elastic.co/guide/en/elasticsearch/reference/master/modules-scripting.html&gt;`_</span>

<span class="sd">        :arg id: Script ID</span>
<span class="sd">        :arg body: The document</span>
<span class="sd">        :arg context: Script context</span>
<span class="sd">        :arg master_timeout: Specify timeout for connection to master</span>
<span class="sd">        :arg timeout: Explicit operation timeout</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">body</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">SKIP_IN_PATH</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Empty value passed for a required argument.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">perform_request</span><span class="p">(</span>
            <span class="s2">&quot;PUT&quot;</span><span class="p">,</span> <span class="n">_make_path</span><span class="p">(</span><span class="s2">&quot;_scripts&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">context</span><span class="p">),</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">body</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Elasticsearch.rank_eval"><a class="viewcode-back" href="../../onegov_testing.html#onegov_testing.fixtures.Elasticsearch.rank_eval">[docs]</a>    <span class="nd">@query_params</span><span class="p">(</span><span class="s2">&quot;allow_no_indices&quot;</span><span class="p">,</span> <span class="s2">&quot;expand_wildcards&quot;</span><span class="p">,</span> <span class="s2">&quot;ignore_unavailable&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">rank_eval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        `&lt;https://www.elastic.co/guide/en/elasticsearch/reference/master/search-rank-eval.html&gt;`_</span>

<span class="sd">        :arg body: The ranking evaluation search definition, including search</span>
<span class="sd">            requests, document ratings and ranking metric definition.</span>
<span class="sd">        :arg index: A comma-separated list of index names to search; use `_all`</span>
<span class="sd">            or empty string to perform the operation on all indices</span>
<span class="sd">        :arg allow_no_indices: Whether to ignore if a wildcard indices</span>
<span class="sd">            expression resolves into no concrete indices. (This includes `_all`</span>
<span class="sd">            string or when no indices have been specified)</span>
<span class="sd">        :arg expand_wildcards: Whether to expand wildcard expression to concrete</span>
<span class="sd">            indices that are open, closed or both., default &#39;open&#39;, valid</span>
<span class="sd">            choices are: &#39;open&#39;, &#39;closed&#39;, &#39;none&#39;, &#39;all&#39;</span>
<span class="sd">        :arg ignore_unavailable: Whether specified concrete indices should be</span>
<span class="sd">            ignored when unavailable (missing or closed)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">body</span> <span class="ow">in</span> <span class="n">SKIP_IN_PATH</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Empty value passed for a required argument &#39;body&#39;.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">perform_request</span><span class="p">(</span>
            <span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">_make_path</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s2">&quot;_rank_eval&quot;</span><span class="p">),</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">body</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Elasticsearch.get_script"><a class="viewcode-back" href="../../onegov_testing.html#onegov_testing.fixtures.Elasticsearch.get_script">[docs]</a>    <span class="nd">@query_params</span><span class="p">(</span><span class="s2">&quot;master_timeout&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">get_script</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        `&lt;http://www.elastic.co/guide/en/elasticsearch/reference/master/modules-scripting.html&gt;`_</span>

<span class="sd">        :arg id: Script ID</span>
<span class="sd">        :arg master_timeout: Specify timeout for connection to master</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">SKIP_IN_PATH</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Empty value passed for a required argument &#39;id&#39;.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">perform_request</span><span class="p">(</span>
            <span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">_make_path</span><span class="p">(</span><span class="s2">&quot;_scripts&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">),</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Elasticsearch.delete_script"><a class="viewcode-back" href="../../onegov_testing.html#onegov_testing.fixtures.Elasticsearch.delete_script">[docs]</a>    <span class="nd">@query_params</span><span class="p">(</span><span class="s2">&quot;master_timeout&quot;</span><span class="p">,</span> <span class="s2">&quot;timeout&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">delete_script</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        `&lt;http://www.elastic.co/guide/en/elasticsearch/reference/master/modules-scripting.html&gt;`_</span>

<span class="sd">        :arg id: Script ID</span>
<span class="sd">        :arg master_timeout: Specify timeout for connection to master</span>
<span class="sd">        :arg timeout: Explicit operation timeout</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">SKIP_IN_PATH</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Empty value passed for a required argument &#39;id&#39;.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">perform_request</span><span class="p">(</span>
            <span class="s2">&quot;DELETE&quot;</span><span class="p">,</span> <span class="n">_make_path</span><span class="p">(</span><span class="s2">&quot;_scripts&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">),</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Elasticsearch.render_search_template"><a class="viewcode-back" href="../../onegov_testing.html#onegov_testing.fixtures.Elasticsearch.render_search_template">[docs]</a>    <span class="nd">@query_params</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">render_search_template</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        `&lt;http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/search-template.html&gt;`_</span>

<span class="sd">        :arg id: The id of the stored search template</span>
<span class="sd">        :arg body: The search definition template and its params</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">perform_request</span><span class="p">(</span>
            <span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">_make_path</span><span class="p">(</span><span class="s2">&quot;_render&quot;</span><span class="p">,</span> <span class="s2">&quot;template&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">),</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">body</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Elasticsearch.scripts_painless_execute"><a class="viewcode-back" href="../../onegov_testing.html#onegov_testing.fixtures.Elasticsearch.scripts_painless_execute">[docs]</a>    <span class="nd">@query_params</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">scripts_painless_execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        `&lt;https://www.elastic.co/guide/en/elasticsearch/painless/master/painless-execute-api.html&gt;`_</span>

<span class="sd">        :arg body: The script to execute</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">perform_request</span><span class="p">(</span>
            <span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="s2">&quot;/_scripts/painless/_execute&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">body</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Elasticsearch.msearch_template"><a class="viewcode-back" href="../../onegov_testing.html#onegov_testing.fixtures.Elasticsearch.msearch_template">[docs]</a>    <span class="nd">@query_params</span><span class="p">(</span>
        <span class="s2">&quot;max_concurrent_searches&quot;</span><span class="p">,</span> <span class="s2">&quot;rest_total_hits_as_int&quot;</span><span class="p">,</span> <span class="s2">&quot;search_type&quot;</span><span class="p">,</span> <span class="s2">&quot;typed_keys&quot;</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="nf">msearch_template</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">doc_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The /_search/template endpoint allows to use the mustache language to</span>
<span class="sd">        pre render search requests, before they are executed and fill existing</span>
<span class="sd">        templates with template parameters.</span>
<span class="sd">        `&lt;http://www.elastic.co/guide/en/elasticsearch/reference/current/search-template.html&gt;`_</span>

<span class="sd">        :arg body: The request definitions (metadata-search request definition</span>
<span class="sd">            pairs), separated by newlines</span>
<span class="sd">        :arg index: A comma-separated list of index names to use as default</span>
<span class="sd">        :arg doc_type: A comma-separated list of document types to use as</span>
<span class="sd">            default</span>
<span class="sd">        :arg max_concurrent_searches: Controls the maximum number of concurrent</span>
<span class="sd">            searches the multi search api will execute</span>
<span class="sd">        :arg rest_total_hits_as_int: This parameter is ignored in this version.</span>
<span class="sd">            It is used in the next major version to control whether the rest</span>
<span class="sd">            response should render the total.hits as an object or a number,</span>
<span class="sd">            default False</span>
<span class="sd">        :arg search_type: Search operation type, valid choices are:</span>
<span class="sd">            &#39;query_then_fetch&#39;, &#39;query_and_fetch&#39;, &#39;dfs_query_then_fetch&#39;,</span>
<span class="sd">            &#39;dfs_query_and_fetch&#39;</span>
<span class="sd">        :arg typed_keys: Specify whether aggregation and suggester names should</span>
<span class="sd">            be prefixed by their respective types in the response</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">body</span> <span class="ow">in</span> <span class="n">SKIP_IN_PATH</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Empty value passed for a required argument &#39;body&#39;.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">perform_request</span><span class="p">(</span>
            <span class="s2">&quot;GET&quot;</span><span class="p">,</span>
            <span class="n">_make_path</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">doc_type</span><span class="p">,</span> <span class="s2">&quot;_msearch&quot;</span><span class="p">,</span> <span class="s2">&quot;template&quot;</span><span class="p">),</span>
            <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
            <span class="n">body</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_bulk_body</span><span class="p">(</span><span class="n">body</span><span class="p">),</span>
            <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;content-type&quot;</span><span class="p">:</span> <span class="s2">&quot;application/x-ndjson&quot;</span><span class="p">},</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Elasticsearch.field_caps"><a class="viewcode-back" href="../../onegov_testing.html#onegov_testing.fixtures.Elasticsearch.field_caps">[docs]</a>    <span class="nd">@query_params</span><span class="p">(</span>
        <span class="s2">&quot;allow_no_indices&quot;</span><span class="p">,</span> <span class="s2">&quot;expand_wildcards&quot;</span><span class="p">,</span> <span class="s2">&quot;fields&quot;</span><span class="p">,</span> <span class="s2">&quot;ignore_unavailable&quot;</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="nf">field_caps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The field capabilities API allows to retrieve the capabilities of fields among multiple indices.</span>
<span class="sd">        `&lt;http://www.elastic.co/guide/en/elasticsearch/reference/current/search-field-caps.html&gt;`_</span>

<span class="sd">        :arg index: A comma-separated list of index names; use `_all` or empty</span>
<span class="sd">            string to perform the operation on all indices</span>
<span class="sd">        :arg body: Field json objects containing an array of field names</span>
<span class="sd">        :arg allow_no_indices: Whether to ignore if a wildcard indices</span>
<span class="sd">            expression resolves into no concrete indices. (This includes `_all`</span>
<span class="sd">            string or when no indices have been specified)</span>
<span class="sd">        :arg expand_wildcards: Whether to expand wildcard expression to concrete</span>
<span class="sd">            indices that are open, closed or both., default &#39;open&#39;, valid</span>
<span class="sd">            choices are: &#39;open&#39;, &#39;closed&#39;, &#39;none&#39;, &#39;all&#39;</span>
<span class="sd">        :arg fields: A comma-separated list of field names</span>
<span class="sd">        :arg ignore_unavailable: Whether specified concrete indices should be</span>
<span class="sd">            ignored when unavailable (missing or closed)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">perform_request</span><span class="p">(</span>
            <span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">_make_path</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s2">&quot;_field_caps&quot;</span><span class="p">),</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">body</span>
        <span class="p">)</span></div></div>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../index.html">
    <img class="logo" src="../../_static/logo.svg" alt="Logo"/>
    
  </a>
</p>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=OneGov&repo=onegov-docs&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>


<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2015, Verein OneGov.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.1.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>