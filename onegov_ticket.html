
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Onegov Ticket API &#8212; OneGov Docs 0.0.1 documentation</title>
    <link rel="stylesheet" href="_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="onegov-ticket-api">
<h1>Onegov Ticket API<a class="headerlink" href="#onegov-ticket-api" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-onegov.ticket.model">
<span id="models"></span><h2>Models<a class="headerlink" href="#module-onegov.ticket.model" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="onegov.ticket.model.Ticket">
<em class="property">class </em><code class="descclassname">onegov.ticket.model.</code><code class="descname">Ticket</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/onegov/ticket/model.html#Ticket"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#onegov.ticket.model.Ticket" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines a ticket.</p>
<dl class="attribute">
<dt id="onegov.ticket.model.Ticket.id">
<code class="descname">id</code><a class="headerlink" href="#onegov.ticket.model.Ticket.id" title="Permalink to this definition">¶</a></dt>
<dd><p>the internal number of the ticket -&gt; may be used as an access key
for anonymous users</p>
</dd></dl>

<dl class="attribute">
<dt id="onegov.ticket.model.Ticket.number">
<code class="descname">number</code><a class="headerlink" href="#onegov.ticket.model.Ticket.number" title="Permalink to this definition">¶</a></dt>
<dd><p>the unique ticket number known to the end-user -&gt; do <em>not</em> use this to
access the ticket as an anonymous user, the number is unique, but it’s
not unguessable!</p>
</dd></dl>

<dl class="attribute">
<dt id="onegov.ticket.model.Ticket.title">
<code class="descname">title</code><a class="headerlink" href="#onegov.ticket.model.Ticket.title" title="Permalink to this definition">¶</a></dt>
<dd><p>the title of the ticket</p>
</dd></dl>

<dl class="attribute">
<dt id="onegov.ticket.model.Ticket.subtitle">
<code class="descname">subtitle</code><a class="headerlink" href="#onegov.ticket.model.Ticket.subtitle" title="Permalink to this definition">¶</a></dt>
<dd><p>the subtitle of the ticket for extra information about it’s content</p>
</dd></dl>

<dl class="attribute">
<dt id="onegov.ticket.model.Ticket.group">
<code class="descname">group</code><a class="headerlink" href="#onegov.ticket.model.Ticket.group" title="Permalink to this definition">¶</a></dt>
<dd><p>the group this ticket belongs to. used to differentiate tickets
belonging to one specific handler (handler -&gt; group -&gt; title)</p>
</dd></dl>

<dl class="attribute">
<dt id="onegov.ticket.model.Ticket.handler_code">
<code class="descname">handler_code</code><a class="headerlink" href="#onegov.ticket.model.Ticket.handler_code" title="Permalink to this definition">¶</a></dt>
<dd><p>the name of the handler associated with this ticket, may be used to
create custom polymorphic subclasses of this class. See
<a class="reference external" href="http://docs.sqlalchemy.org/en/improve_toc/ orm/extensions/declarative/inheritance.html">http://docs.sqlalchemy.org/en/improve_toc/ orm/extensions/declarative/inheritance.html</a>.</p>
</dd></dl>

<dl class="attribute">
<dt id="onegov.ticket.model.Ticket.handler_id">
<code class="descname">handler_id</code><a class="headerlink" href="#onegov.ticket.model.Ticket.handler_id" title="Permalink to this definition">¶</a></dt>
<dd><p>a unique id for the handler record</p>
</dd></dl>

<dl class="attribute">
<dt id="onegov.ticket.model.Ticket.handler_data">
<code class="descname">handler_data</code><a class="headerlink" href="#onegov.ticket.model.Ticket.handler_data" title="Permalink to this definition">¶</a></dt>
<dd><p>the data associated with the handler, not meant to be loaded in a list,
therefore deferred.</p>
</dd></dl>

<dl class="attribute">
<dt id="onegov.ticket.model.Ticket.snapshot">
<code class="descname">snapshot</code><a class="headerlink" href="#onegov.ticket.model.Ticket.snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>a snapshot of the ticket containing the last summary that made any sense
use this before deleting the model behind a ticket, lest your ticket
becomes nothing more than a number.</p>
</dd></dl>

<dl class="attribute">
<dt id="onegov.ticket.model.Ticket.last_state_change">
<code class="descname">last_state_change</code><a class="headerlink" href="#onegov.ticket.model.Ticket.last_state_change" title="Permalink to this definition">¶</a></dt>
<dd><p>a timestamp recorded every time the state changes</p>
</dd></dl>

<dl class="attribute">
<dt id="onegov.ticket.model.Ticket.reaction_time">
<code class="descname">reaction_time</code><a class="headerlink" href="#onegov.ticket.model.Ticket.reaction_time" title="Permalink to this definition">¶</a></dt>
<dd><p>the time in seconds between the ticket’s creation and the time it
got accepted (changed from open to pending)</p>
</dd></dl>

<dl class="attribute">
<dt id="onegov.ticket.model.Ticket.process_time">
<code class="descname">process_time</code><a class="headerlink" href="#onegov.ticket.model.Ticket.process_time" title="Permalink to this definition">¶</a></dt>
<dd><p>the time in seconds a ticket was in the pending state -
may be a moving target, so use <code class="xref py py-attr docutils literal"><span class="pre">current_process_time</span></code> to get the
adjusted process_time based on the current time.
<code class="docutils literal"><span class="pre">process_time</span></code> itself is only accurate if the ticket is closed, so in
reports make sure to account for the ticket state.</p>
</dd></dl>

<dl class="attribute">
<dt id="onegov.ticket.model.Ticket.muted">
<code class="descname">muted</code><a class="headerlink" href="#onegov.ticket.model.Ticket.muted" title="Permalink to this definition">¶</a></dt>
<dd><p>true if the notifications for this ticket should be muted</p>
</dd></dl>

<dl class="attribute">
<dt id="onegov.ticket.model.Ticket.state">
<code class="descname">state</code><a class="headerlink" href="#onegov.ticket.model.Ticket.state" title="Permalink to this definition">¶</a></dt>
<dd><p>the state of this ticket (open, pending, closed)</p>
</dd></dl>

<dl class="attribute">
<dt id="onegov.ticket.model.Ticket.user_id">
<code class="descname">user_id</code><a class="headerlink" href="#onegov.ticket.model.Ticket.user_id" title="Permalink to this definition">¶</a></dt>
<dd><p>the user that owns this ticket with this ticket (optional)</p>
</dd></dl>

<dl class="attribute">
<dt id="onegov.ticket.model.Ticket.extra_localized_text">
<code class="descname">extra_localized_text</code><a class="headerlink" href="#onegov.ticket.model.Ticket.extra_localized_text" title="Permalink to this definition">¶</a></dt>
<dd><p>Maybe used by child-classes to return localized extra data that
should be indexed as well.</p>
</dd></dl>

<dl class="attribute">
<dt id="onegov.ticket.model.Ticket.handler">
<code class="descname">handler</code><a class="headerlink" href="#onegov.ticket.model.Ticket.handler" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an instance of the handler associated with this ticket.</p>
</dd></dl>

<dl class="method">
<dt id="onegov.ticket.model.Ticket.create_snapshot">
<code class="descname">create_snapshot</code><span class="sig-paren">(</span><em>request</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/onegov/ticket/model.html#Ticket.create_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#onegov.ticket.model.Ticket.create_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes the current handler and stores the output of the summary
as a snapshot.</p>
<p>TODO: This doesn’t support multiple langauges at this point. The
language of the user creating the snapshot will be what’s stored.</p>
<p>In the future we might change this by iterating over all supported
languages and creating the summary for each language.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-onegov.ticket.collection">
<span id="collection"></span><h2>Collection<a class="headerlink" href="#module-onegov.ticket.collection" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="onegov.ticket.collection.TicketCount">
<em class="property">class </em><code class="descclassname">onegov.ticket.collection.</code><code class="descname">TicketCount</code><span class="sig-paren">(</span><em>open</em>, <em>pending</em>, <em>closed</em><span class="sig-paren">)</span><a class="headerlink" href="#onegov.ticket.collection.TicketCount" title="Permalink to this definition">¶</a></dt>
<dd><dl class="attribute">
<dt id="onegov.ticket.collection.TicketCount.closed">
<code class="descname">closed</code><a class="headerlink" href="#onegov.ticket.collection.TicketCount.closed" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="attribute">
<dt id="onegov.ticket.collection.TicketCount.open">
<code class="descname">open</code><a class="headerlink" href="#onegov.ticket.collection.TicketCount.open" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="attribute">
<dt id="onegov.ticket.collection.TicketCount.pending">
<code class="descname">pending</code><a class="headerlink" href="#onegov.ticket.collection.TicketCount.pending" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-onegov.ticket.handler">
<span id="handler"></span><h2>Handler<a class="headerlink" href="#module-onegov.ticket.handler" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="onegov.ticket.handler.Handler">
<em class="property">class </em><code class="descclassname">onegov.ticket.handler.</code><code class="descname">Handler</code><span class="sig-paren">(</span><em>ticket</em>, <em>handler_id</em>, <em>handler_data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/onegov/ticket/handler.html#Handler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#onegov.ticket.handler.Handler" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines a generic handler, responsible for a subset of the tickets.</p>
<p>onegov.ticket is meant to be a rather generic bucket of tickets, to which
varying modules submit tickets with varying content and different
actionables.</p>
<p>Each module wanting to submit tickets needs to implement a handler with
a unique id and a unique short code. The short code is added in front of
the ticket number.</p>
<p>Tickets submitted to the database are shown in a list, without handler
involvement. When a ticket is displayed, the handler is called with
whatever data the handler supplied during ticket submission.</p>
<p>The handler then uses the handler data to access whatever data it needs
to display a summary as well as links to certain actions (possibly a link
to the original item, links that change the state of the ticket as well
as the data associated with the handler, etc.).</p>
<dl class="method">
<dt id="onegov.ticket.handler.Handler.refresh">
<code class="descname">refresh</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/onegov/ticket/handler.html#Handler.refresh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#onegov.ticket.handler.Handler.refresh" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates the current ticket with the latest data from the handler.</p>
</dd></dl>

<dl class="attribute">
<dt id="onegov.ticket.handler.Handler.email">
<code class="descname">email</code><a class="headerlink" href="#onegov.ticket.handler.Handler.email" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the email address behind the ticket request.</p>
</dd></dl>

<dl class="attribute">
<dt id="onegov.ticket.handler.Handler.title">
<code class="descname">title</code><a class="headerlink" href="#onegov.ticket.handler.Handler.title" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the title of the ticket. If this title may change over
time, the handler must call <code class="xref py py-meth docutils literal"><span class="pre">self.refresh()</span></code> when there’s a change.</p>
</dd></dl>

<dl class="attribute">
<dt id="onegov.ticket.handler.Handler.group">
<code class="descname">group</code><a class="headerlink" href="#onegov.ticket.handler.Handler.group" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the group of the ticket. If this group may change over
time, the handler must call <code class="xref py py-meth docutils literal"><span class="pre">self.refresh()</span></code> when there’s a change.</p>
</dd></dl>

<dl class="attribute">
<dt id="onegov.ticket.handler.Handler.deleted">
<code class="descname">deleted</code><a class="headerlink" href="#onegov.ticket.handler.Handler.deleted" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns true if the underlying model was deleted. It is best to
never let that happen, as we want tickets to stay around forever.</p>
<p>However, this can make sense in certain scenarios. Note that if
you do delete your underlying model, make sure to call
<code class="xref py py-meth docutils literal"><span class="pre">onegov.ticket.models.Ticket.create_snapshot()</span></code> beforehand!</p>
</dd></dl>

<dl class="attribute">
<dt id="onegov.ticket.handler.Handler.extra_data">
<code class="descname">extra_data</code><a class="headerlink" href="#onegov.ticket.handler.Handler.extra_data" title="Permalink to this definition">¶</a></dt>
<dd><p>An array of string values which are indexed in elasticsearch when
the ticket is stored there.</p>
</dd></dl>

<dl class="attribute">
<dt id="onegov.ticket.handler.Handler.payment">
<code class="descname">payment</code><a class="headerlink" href="#onegov.ticket.handler.Handler.payment" title="Permalink to this definition">¶</a></dt>
<dd><p>An optional link to a onegov.pay payment record.</p>
</dd></dl>

<dl class="classmethod">
<dt id="onegov.ticket.handler.Handler.handle_extra_parameters">
<em class="property">classmethod </em><code class="descname">handle_extra_parameters</code><span class="sig-paren">(</span><em>session</em>, <em>query</em>, <em>extra_parameters</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/onegov/ticket/handler.html#Handler.handle_extra_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#onegov.ticket.handler.Handler.handle_extra_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a dictionary of extra parameters and uses it to optionally
modifiy the query used for the collection.</p>
<p>Use this to add handler-defined custom filters with extra query
parameters. Only called if the collection is already limited to the
given handler. If all handlers are shown in the collection, this
method is not called.</p>
<p>If no extra paramaters were given, this method is <em>not</em> called.</p>
<p>Returns the modified or unmodified query.</p>
</dd></dl>

<dl class="method">
<dt id="onegov.ticket.handler.Handler.get_summary">
<code class="descname">get_summary</code><span class="sig-paren">(</span><em>request</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/onegov/ticket/handler.html#Handler.get_summary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#onegov.ticket.handler.Handler.get_summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the summary of the current ticket as a html string.</p>
</dd></dl>

<dl class="method">
<dt id="onegov.ticket.handler.Handler.get_links">
<code class="descname">get_links</code><span class="sig-paren">(</span><em>request</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/onegov/ticket/handler.html#Handler.get_links"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#onegov.ticket.handler.Handler.get_links" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the links associated with the current ticket in the
following format:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;Link Title&#39;</span><span class="p">,</span> <span class="s1">&#39;http://link&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;Link Title 2&#39;</span><span class="p">,</span> <span class="s1">&#39;http://link2&#39;</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>
</div>
<p>If the links are not tuples, but callables, they will be called with
the request which should return the rendered link.</p>
</dd></dl>

</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="index.html">
    <img class="logo" src="_static/logo.svg" alt="Logo"/>
    
  </a>
</p>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=OneGov&repo=onegov-docs&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>


<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2015, Verein OneGov.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="_sources/onegov_ticket.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>